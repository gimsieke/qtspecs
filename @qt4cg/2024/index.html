<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses in 2024</title></head><body><main><article><h1>@qt4cg statuses in 2024</h1><p>This page displays status
              updates
              about the QT4 CG project from 2024.</p><p>See also <a href="../">recent statuses</a>.</p><div class="toots">
<div class="toot" id="created-972"><h2>Pull request #972 created<span class="toot-id"> #created-972</span></h2><div class="pubdate">29 Jan at 11:28:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/972">https://github.com/qt4cg/qtspecs/pull/972</a></div><details><summary>949 Partial Function Applications: Allow return of function name</summary><div class="markup"><p>Issue: #949. The major change is the rule for the <code>name</code> property of partial function applications for static function calls.</p>
<p>In addition, I have unified the presentation of the different function item expressions.</p>
<p>Affects test cases like <code>xqhof40</code> (which need to be fixed with or without this PR).</p>
</div></details></div>
<div class="toot" id="created-971"><h2>Pull request #971 created<span class="toot-id"> #created-971</span></h2><div class="pubdate">29 Jan at 10:20:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/971">https://github.com/qt4cg/qtspecs/pull/971</a></div><details><summary>970 XQFO: Context item → value</summary><div class="markup"><p>Issue: #970</p>
</div></details></div>
<div class="toot" id="created-970"><h2>Issue #970 created<span class="toot-id"> #created-970</span></h2><div class="pubdate">28 Jan at 10:38:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/970">https://github.com/qt4cg/qtspecs/issues/970</a></div><details><summary>XQFO: Context item → value</summary><div class="markup"><p>Resulting from #129 (related: #755): Many rules in the XQFO spec still refer to the context item, which is currently defined as follows:</p>
<blockquote>
<p>When the context value is a single item, it can also be referred to as the context item; when it is a single node, it can also be referred to as the context node.</p>
</blockquote>
<p>We need to make clear what’s going to happen if the context value is not a single item:</p>
<ul>
<li>In many cases, this can simply be done by replacing “context item” with “context value”.</li>
<li>In some cases (e.g. for <code>fn:string#0</code>), we should specify that an error is raised (usually <code>XPTY0004</code>) if the input is not a single item.</li>
</ul>
</div></details></div>
<div class="toot" id="closed-878"><h2>Issue #878 closed<span class="toot-id"> #closed-878</span></h2><div class="pubdate">25 Jan at 08:42:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/878">https://github.com/qt4cg/qtspecs/issues/878</a></div><p>Proposed extension to subsequence</p></div>
<div class="toot" id="created-969"><h2>Pull request #969 created<span class="toot-id"> #created-969</span></h2><div class="pubdate">24 Jan at 18:19:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/969">https://github.com/qt4cg/qtspecs/pull/969</a></div><details><summary>843-partial Standard, array &amp; map functions: Equivalencies</summary><div class="markup"><p>Issue: #843</p>
<p>Maybe we should keep the issue open after merging this PR.</p>
</div></details></div>
<div class="toot" id="created-968"><h2>Pull request #968 created<span class="toot-id"> #created-968</span></h2><div class="pubdate">24 Jan at 17:57:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/968">https://github.com/qt4cg/qtspecs/pull/968</a></div><details><summary>260 array:index-of</summary><div class="markup"><p>Issue: #260</p>
</div></details></div>
<div class="toot" id="created-967"><h2>Issue #967 created<span class="toot-id"> #created-967</span></h2><div class="pubdate">24 Jan at 13:22:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/967">https://github.com/qt4cg/qtspecs/issues/967</a></div><details><summary>XPath Appendix I: Comparisons</summary><div class="markup"><p>Adopted from https://github.com/qt4cg/qtspecs/issues/260#issuecomment-1908033129</p>
<blockquote>
<p>It would be useful if all functions that perform comparison included a cross-reference to the new XPath Appendix I; and I note that appendix doesn't seem to mention index-of.</p>
</blockquote>
<p>@michaelhkay I’ve taken the liberty of assigning this to you, as I wasn’t sure what this is about.</p>
</div></details></div>
<div class="toot" id="closed-874"><h2>Issue #874 closed<span class="toot-id"> #closed-874</span></h2><div class="pubdate">24 Jan at 09:51:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/874">https://github.com/qt4cg/qtspecs/pull/874</a></div><p>878 Proposed extension to subsequence</p></div>
<div class="toot" id="created-966"><h2>Issue #966 created<span class="toot-id"> #created-966</span></h2><div class="pubdate">23 Jan at 20:23:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/966">https://github.com/qt4cg/qtspecs/issues/966</a></div><details><summary>Rewrite spec of deep lookup operator: edits</summary><div class="markup"><p>@michaelhkay I've created a little new issue to keep track of the 3 minor suggestions that I made in the PR that we merged today: https://github.com/qt4cg/qtspecs/pull/927</p>
</div></details></div>
<div class="toot" id="created-965"><h2>Pull request #965 created<span class="toot-id"> #created-965</span></h2><div class="pubdate">23 Jan at 18:20:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/965">https://github.com/qt4cg/qtspecs/pull/965</a></div><p>XQFO: minor edits and bug fixes</p></div>
<div class="toot" id="closed-818"><h2>Issue #818 closed<span class="toot-id"> #closed-818</span></h2><div class="pubdate">23 Jan at 17:52:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/818">https://github.com/qt4cg/qtspecs/issues/818</a></div><p>Foxpath integration</p></div>
<div class="toot" id="closed-693"><h2>Issue #693 closed<span class="toot-id"> #closed-693</span></h2><div class="pubdate">23 Jan at 17:52:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/693">https://github.com/qt4cg/qtspecs/issues/693</a></div><p>QT4 Tests without counterpart in the specs</p></div>
<div class="toot" id="closed-639"><h2>Issue #639 closed<span class="toot-id"> #closed-639</span></h2><div class="pubdate">23 Jan at 17:52:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/639">https://github.com/qt4cg/qtspecs/issues/639</a></div><p>fn:void: Naming, Arguments</p></div>
<div class="toot" id="closed-937"><h2>Issue #937 closed<span class="toot-id"> #closed-937</span></h2><div class="pubdate">23 Jan at 17:50:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/937">https://github.com/qt4cg/qtspecs/pull/937</a></div><p>779 hash function</p></div>
<div class="toot" id="closed-946"><h2>Issue #946 closed<span class="toot-id"> #closed-946</span></h2><div class="pubdate">23 Jan at 17:46:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/946">https://github.com/qt4cg/qtspecs/issues/946</a></div><p>fn:iterate-while → fn:while-do, fn:do-until</p></div>
<div class="toot" id="closed-962"><h2>Issue #962 closed<span class="toot-id"> #closed-962</span></h2><div class="pubdate">23 Jan at 17:46:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/962">https://github.com/qt4cg/qtspecs/pull/962</a></div><p>946 fn:iterate-while → fn:while-do, fn:do-until</p></div>
<div class="toot" id="closed-951"><h2>Issue #951 closed<span class="toot-id"> #closed-951</span></h2><div class="pubdate">23 Jan at 17:42:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/951">https://github.com/qt4cg/qtspecs/issues/951</a></div><p>Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-with-id</p></div>
<div class="toot" id="closed-958"><h2>Issue #958 closed<span class="toot-id"> #closed-958</span></h2><div class="pubdate">23 Jan at 17:41:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/958">https://github.com/qt4cg/qtspecs/pull/958</a></div><p>951 Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-id</p></div>
<div class="toot" id="closed-945"><h2>Issue #945 closed<span class="toot-id"> #closed-945</span></h2><div class="pubdate">23 Jan at 17:38:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/945">https://github.com/qt4cg/qtspecs/issues/945</a></div><p>Module import: apparent contradiction</p></div>
<div class="toot" id="closed-952"><h2>Issue #952 closed<span class="toot-id"> #closed-952</span></h2><div class="pubdate">23 Jan at 17:38:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/952">https://github.com/qt4cg/qtspecs/pull/952</a></div><p>945 module import contradiction</p></div>
<div class="toot" id="closed-950"><h2>Issue #950 closed<span class="toot-id"> #closed-950</span></h2><div class="pubdate">23 Jan at 17:34:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/950">https://github.com/qt4cg/qtspecs/pull/950</a></div><p>Minor edits (examples, rules)</p></div>
<div class="toot" id="closed-939"><h2>Issue #939 closed<span class="toot-id"> #closed-939</span></h2><div class="pubdate">23 Jan at 17:31:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/939">https://github.com/qt4cg/qtspecs/issues/939</a></div><p>Remove fn:numeric-compare</p></div>
<div class="toot" id="closed-941"><h2>Issue #941 closed<span class="toot-id"> #closed-941</span></h2><div class="pubdate">23 Jan at 17:31:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/941">https://github.com/qt4cg/qtspecs/pull/941</a></div><p>939 Remove fn:numeric-compare</p></div>
<div class="toot" id="closed-936"><h2>Issue #936 closed<span class="toot-id"> #closed-936</span></h2><div class="pubdate">23 Jan at 17:28:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/936">https://github.com/qt4cg/qtspecs/pull/936</a></div><p>877 revised rules for op:binary-less-than</p></div>
<div class="toot" id="closed-861"><h2>Issue #861 closed<span class="toot-id"> #closed-861</span></h2><div class="pubdate">23 Jan at 17:25:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/861">https://github.com/qt4cg/qtspecs/issues/861</a></div><p>Precise meaning of $E??KS</p></div>
<div class="toot" id="closed-927"><h2>Issue #927 closed<span class="toot-id"> #closed-927</span></h2><div class="pubdate">23 Jan at 17:25:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/927">https://github.com/qt4cg/qtspecs/pull/927</a></div><p>861 Rewrite spec of deep lookup operator</p></div>
<div class="toot" id="minutes-01-23"><h2>QT4 CG meeting 062 draft minutes<span class="toot-id"> #minutes-01-23</span></h2><div class="pubdate">23 Jan at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/01-23">https://qt4cg.org/meeting/minutes/2024/01-23</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-964"><h2>Issue #964 created<span class="toot-id"> #created-964</span></h2><div class="pubdate">23 Jan at 12:30:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/964">https://github.com/qt4cg/qtspecs/issues/964</a></div><details><summary>fn:has-attributes</summary><div class="markup"><p>Trivial (motivated by a user request):</p>
<p>As there is an <code>fn:has-children</code> function, it seems surprising that there is no <code>fn:has-attributes</code> function.</p>
<p>I would suggest…</p>
<ul>
<li>adding this function to the spec, or</li>
<li>indicating in a note (for <code>fn:has-children</code>) why this function is missing.</li>
</ul>
</div></details></div>
<div class="toot" id="created-963"><h2>Issue #963 created<span class="toot-id"> #created-963</span></h2><div class="pubdate">23 Jan at 08:29:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/963">https://github.com/qt4cg/qtspecs/issues/963</a></div><details><summary>Errors in forming function items (continued)</summary><div class="markup"><p>In #894, the following rule was added to the definition of <strong>Named Function References</strong>:</p>
<blockquote>
<p>An error is raised if the identified function depends on components of the static or dynamic context that are not present, or that have unsuitable values. […] <code>DC0001</code> is raised for the call <code>fn:id#1</code> if the context item is not a node in a tree that is rooted at a document node.</p>
</blockquote>
<p>We should be consistent and add this rule to <strong>Partial Function Applications</strong> and <strong>Inline Function Expressions</strong> as well. Perhaps such rules could be defined just once for all affected function item constructors in the parent section?</p>
<p>Also, the error code doesn’t seem to be properly defined in the spec, it shows <code>[ERROR errorref DC0001 NOT FOUND]</code> (maybe that’s intentional at this editing stage.)</p>
</div></details></div>
<div class="toot" id="agenda-01-23"><h2>QT4 CG meeting 062 draft agenda<span class="toot-id"> #agenda-01-23</span></h2><div class="pubdate">22 Jan at 14:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/01-23">https://qt4cg.org/meeting/agenda/2024/01-23</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-962"><h2>Pull request #962 created<span class="toot-id"> #created-962</span></h2><div class="pubdate">20 Jan at 14:24:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/962">https://github.com/qt4cg/qtspecs/pull/962</a></div><details><summary>946 fn:iterate-while → fn:while-do, fn:do-until</summary><div class="markup"><p>My first thought was to name the second function <code>fn:do-while</code>, but <code>fn:do-until</code> with an inversed predicate seemed more appropriate to me.</p>
<p>Issue: #946</p>
</div></details></div>
<div class="toot" id="created-961"><h2>Issue #961 created<span class="toot-id"> #created-961</span></h2><div class="pubdate">20 Jan at 10:11:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/961">https://github.com/qt4cg/qtspecs/issues/961</a></div><details><summary>Simulating Objects: Performance</summary><div class="markup"><p>Related to #953, #917 and #916, I wonder whether we are aware enough of the essential differences when we think of objects in a functional language:</p>
<ul>
<li>Mutable objects are extremely efficient, as an update is a simple main-memory value change.</li>
<li>Immutable data structures need to be fully copied if a single value changes. As a result, the update of a map with, let’s say, 1 string and 50 functions would be a new map with 1 string and 50 functions. Even with efficient immutable map implementations that we have, I doubt that it makes sense to create full copies with 1+50 entries, of which only 1 string will be different.</li>
<li>Imagine a FLWOR expression that creates 1000 of such maps, with possibly 1 value that’s different in each instance. We don’t need 1000 copies of 50 functions; the memory consumption would be much smaller if we only stored relevant values.</li>
</ul>
<p>This thread is not about premature optimization; I just want to be sure we think about the obstacles when using maps for objects. Maybe the solutions are already on the horizon; maybe we could tackle some of the concerns with the definition of default values…</p>
<pre><code class="language-xquery">declare record person(
  name   as xs:string,
  title  := (),
  full   := fn { string-join((?title, ?name), ' ') }
);
</code></pre>
<p>…and maps with type annotations. If we don’t materialize defaults, the embedded annotation would indeed need to effect functions like <code>map:get</code>, as questioned by Michael in https://github.com/qt4cg/qtspecs/pull/953#issuecomment-1896078605.</p>
</div></details></div>
<div class="toot" id="created-960"><h2>Issue #960 created<span class="toot-id"> #created-960</span></h2><div class="pubdate">19 Jan at 16:24:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/960">https://github.com/qt4cg/qtspecs/issues/960</a></div><details><summary>Should ??KS flatten the results</summary><div class="markup"><p>Currently the result of <code>??KS</code> (like <code>?KS</code>) is flattened. So if you do <code>??dimensions</code> and the value of each <code>dimensions</code> entry is a sequence of zero or more numbers, the result munges them all together into a single sequence (dropping any empty values in the process).</p>
<p>Should we change this, for example to return a sequence of arrays, or an array of sequences?</p>
<p>This makes life a bit more difficult in the simple case where all the values are singletons -- and notably, when constructing a path such as <code>??A??B??C</code> -- but it makes it possible to handle the more general case where they aren't all singletons.</p>
</div></details></div>
<div class="toot" id="created-959"><h2>Issue #959 created<span class="toot-id"> #created-959</span></h2><div class="pubdate">18 Jan at 17:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/959">https://github.com/qt4cg/qtspecs/issues/959</a></div><details><summary>Milliseconds ↔ xs:dayTimeDuration, Unix time ↔ xs:dateTime</summary><div class="markup"><p>We should extend the constructor functions to convert integers (millisecond, and the Unix time, starting from <code>1970-01-01T00:00:00Z</code>) to <code>xs:dayTimeDuration</code> and <code>xs:dateTime</code> instances…</p>
<pre><code class="language-xquery">xs:dateTime(12345),
xs:dayTimeDuration(12345)
</code></pre>
<p>…and it should be possible to convert the values back to integers.</p>
<p>Related: https://docs.basex.org/wiki/Conversion_Module#Dates_and_Durations</p>
</div></details></div>
<div class="toot" id="created-958"><h2>Pull request #958 created<span class="toot-id"> #created-958</span></h2><div class="pubdate">18 Jan at 13:39:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/958">https://github.com/qt4cg/qtspecs/pull/958</a></div><details><summary>951 Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-id</summary><div class="markup"><p>Editorial (#951): Reverts the changes made in #901 for 4 context-dependent functions.</p>
</div></details></div>
<div class="toot" id="created-957"><h2>Pull request #957 created<span class="toot-id"> #created-957</span></h2><div class="pubdate">18 Jan at 01:31:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/957">https://github.com/qt4cg/qtspecs/pull/957</a></div><details><summary>948 Added fn:scan-left and fn:scan-right</summary><div class="markup"><p>As discussed at https://github.com/qt4cg/qtspecs/issues/948</p>
</div></details></div>
<div class="toot" id="created-956"><h2>Pull request #956 created<span class="toot-id"> #created-956</span></h2><div class="pubdate">17 Jan at 17:41:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/956">https://github.com/qt4cg/qtspecs/pull/956</a></div><details><summary>850-partial Editorial improvements to parse-html()</summary><div class="markup"><p>Related to issue #850, but doesn't close it entirely.</p>
</div></details></div>
<div class="toot" id="created-955"><h2>Issue #955 created<span class="toot-id"> #created-955</span></h2><div class="pubdate">17 Jan at 12:00:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/955">https://github.com/qt4cg/qtspecs/issues/955</a></div><details><summary>Options parameters as record types</summary><div class="markup"><p>In the new parse-html() function, the content of the options parameter is described using a record type. This differs from other functions, that describe the type as map(*), and have a statement that "the option parameter conventions apply".</p>
<p>Ideally we should use record types for all options parameters. However we need to check carefully that this does not affect edge-case compatibility, for example implicit conversions or the acceptability of extensions. If we can't do that then we should bring parse-html() into line with other functions such as parse-json().</p>
</div></details></div>
<div class="toot" id="created-954"><h2>Issue #954 created<span class="toot-id"> #created-954</span></h2><div class="pubdate">17 Jan at 00:45:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/954">https://github.com/qt4cg/qtspecs/issues/954</a></div><details><summary>Establish a default value for the XSLT fixed-namespaces attribute</summary><div class="markup"><p>The newly-defined <a href="https://qt4cg.org/specifications/xslt-40/Overview.html#fixed-namespaces"><strong>fixed-namespaces</strong> attribute</a> on the <em><code>xsl:stylesheet</code></em> element is a huge positive step towards improving programmer's productivity by removing the need to provide up to 9 namespace declarations in every stylesheet module, thus reducing unnecessary cluttering, simplifying and slimming the code and increasing its readability.</p>
<p>It seems like an accidental omission that the current text doesn't specify a default value for this attribute. If there is a well-chosen default value, this would even further decrease the requirements for the programmer to engage in such a non-problem-solving activity as entering memorized strings, and would prevent errors such as either not providing the correct values for the namespace-uris or forgetting to specify this new attribute.</p>
<p>One obvious candidate for a default value of the <strong>fixed-namespaces</strong> attribute is <code>#standard</code>, which means that without having to press even a single additional key, the XSLT programmer gets all standard namespaces automatically bound to the well-known prefixes:</p>
<p><code>xsl</code> <code>xml</code> <code>xs</code> <code>xsi</code> <code>fn</code>  <code>math</code> <code>map</code> <code>array</code> <code>err</code></p>
<h3>Proposal:</h3>
<p>Please, augment the current text by specifying that the default value for the <strong>fixed-namespaces</strong> attribute is <code>#standard</code></p>
</div></details></div>
<div class="toot" id="created-953"><h2>Pull request #953 created<span class="toot-id"> #created-953</span></h2><div class="pubdate">16 Jan at 23:10:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/953">https://github.com/qt4cg/qtspecs/pull/953</a></div><details><summary>617 Define record constructors</summary><div class="markup"><p>Fix #617</p>
<p>Note that this is a first step. Noticeably we can't yet use these constructor functions to create records that have methods. It's nevertheless a big step forward.</p>
</div></details></div>
<div class="toot" id="created-952"><h2>Pull request #952 created<span class="toot-id"> #created-952</span></h2><div class="pubdate">16 Jan at 18:52:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/952">https://github.com/qt4cg/qtspecs/pull/952</a></div><details><summary>945 module import contradiction</summary><div class="markup"><p>Soem editorial clarifications regarding XQuery module import and schema import.</p>
<p>Fix #945</p>
</div></details></div>
<div class="toot" id="closed-928"><h2>Issue #928 closed<span class="toot-id"> #closed-928</span></h2><div class="pubdate">16 Jan at 17:33:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/928">https://github.com/qt4cg/qtspecs/pull/928</a></div><p>Minor edits through ch. 15</p></div>
<div class="toot" id="closed-947"><h2>Issue #947 closed<span class="toot-id"> #closed-947</span></h2><div class="pubdate">16 Jan at 17:30:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/947">https://github.com/qt4cg/qtspecs/pull/947</a></div><p>Reorganise F+O chapter 15 [editorial]</p></div>
<div class="toot" id="closed-530"><h2>Issue #530 closed<span class="toot-id"> #closed-530</span></h2><div class="pubdate">16 Jan at 17:26:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/530">https://github.com/qt4cg/qtspecs/issues/530</a></div><p>Escaping of forward slash in JSON output method</p></div>
<div class="toot" id="closed-942"><h2>Issue #942 closed<span class="toot-id"> #closed-942</span></h2><div class="pubdate">16 Jan at 17:26:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/942">https://github.com/qt4cg/qtspecs/pull/942</a></div><p>530 Fix typo, escape-solidus not escape-uri-attributes</p></div>
<div class="toot" id="closed-880"><h2>Issue #880 closed<span class="toot-id"> #closed-880</span></h2><div class="pubdate">16 Jan at 17:26:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/880">https://github.com/qt4cg/qtspecs/pull/880</a></div><p>872 Symmetry: fn:items-at → fn:get</p></div>
<div class="toot" id="minutes-01-16"><h2>QT4 CG meeting 061 draft minutes<span class="toot-id"> #minutes-01-16</span></h2><div class="pubdate">16 Jan at 17:25:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/01-16">https://qt4cg.org/meeting/minutes/2024/01-16</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-930"><h2>Issue #930 closed<span class="toot-id"> #closed-930</span></h2><div class="pubdate">16 Jan at 17:23:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/930">https://github.com/qt4cg/qtspecs/issues/930</a></div><p>Obsolete comment under fn:deep-equal()</p></div>
<div class="toot" id="closed-933"><h2>Issue #933 closed<span class="toot-id"> #closed-933</span></h2><div class="pubdate">16 Jan at 17:23:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/933">https://github.com/qt4cg/qtspecs/pull/933</a></div><p>930 drop obsolete note about comments and PIs</p></div>
<div class="toot" id="closed-932"><h2>Issue #932 closed<span class="toot-id"> #closed-932</span></h2><div class="pubdate">16 Jan at 17:20:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/932">https://github.com/qt4cg/qtspecs/pull/932</a></div><p>931 Add rules for duration precision</p></div>
<div class="toot" id="closed-931"><h2>Issue #931 closed<span class="toot-id"> #closed-931</span></h2><div class="pubdate">16 Jan at 17:20:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/931">https://github.com/qt4cg/qtspecs/issues/931</a></div><p>Precision of duration arithmetic</p></div>
<div class="toot" id="closed-737"><h2>Issue #737 closed<span class="toot-id"> #closed-737</span></h2><div class="pubdate">16 Jan at 17:17:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/737">https://github.com/qt4cg/qtspecs/pull/737</a></div><p>295: Boost the capability of recursive record types</p></div>
<div class="toot" id="created-951"><h2>Issue #951 created<span class="toot-id"> #created-951</span></h2><div class="pubdate">16 Jan at 13:58:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/951">https://github.com/qt4cg/qtspecs/issues/951</a></div><details><summary>Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-with-id</summary><div class="markup"><p>Since #895, absent optional arguments and empty sequences in built-in functions are treated identically. Exceptions are functions that already had different rules for such cases (e.g., <code>fn:node(())</code> always returns an empty sequence, no matter what the context is).</p>
<p>I noticed we should also exclude <code>fn:lang</code>, <code>fn:id</code>, <code>fn:idref</code>, and <code>fn:element-with-id</code>: Otherwise, a compiler won’t be able to statically assess if a function call is dependent on the context.</p>
</div></details></div>
<div class="toot" id="created-950"><h2>Pull request #950 created<span class="toot-id"> #created-950</span></h2><div class="pubdate">16 Jan at 11:53:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/950">https://github.com/qt4cg/qtspecs/pull/950</a></div><details><summary>Minor edits (examples, rules)</summary><div class="markup"><ul>
<li>Examples were fixed.</li>
<li>The equivalent expression for <code>map:values</code> was changed to <code>$map?*</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-949"><h2>Issue #949 created<span class="toot-id"> #created-949</span></h2><div class="pubdate">16 Jan at 11:21:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/949">https://github.com/qt4cg/qtspecs/issues/949</a></div><details><summary>Partial Function Applications: Allow return of function name</summary><div class="markup"><p>Without wanting to revive #889, an important observation I picked up is that named function references and “partially applied functions without applications” can be considered identical. That is, there should be no reason to distinguish between <code>count#1</code> and <code>count(?)</code>.</p>
<p>Currently, however, partially applied functions are currently defined to lose the reference to the original function and its arity (and some Qt4 tests ensure that this is the case: https://github.com/qt4cg/qt4tests/blob/8649941e0e695ff8fb4cb27c52e99590cc88126f/misc/HigherOrderFunctions.xml#L1933).</p>
<p>From a user perspective, I see no reason why the two cases should be treated differently, and I would argue that we should either treat them identically or (at least) allow implementations to treat them identically, i.e., allowing an implementation to return <code>count</code> for <code>function-name(count(?))</code>.</p>
</div></details></div>
<div class="toot" id="created-948"><h2>Issue #948 created<span class="toot-id"> #created-948</span></h2><div class="pubdate">15 Jan at 18:59:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/948">https://github.com/qt4cg/qtspecs/issues/948</a></div><details><summary>fn:scan-left and fn:scan-right - produce accumulation of results</summary><div class="markup"><h1>fn:scan-left and fn:scan-right - produce accumulation of results</h1>
<p>In XPath 4.0 so far we still don't have a convenient way to express the functionality of producing a series of accumulated (accrued) results when applying a folding function over a collection (sequence, array, ...) of items. The general use-case for this is the task to produce a sequence of running totals when applying an operation over a sequence of data points: <strong>produce the partial sums of loan payments</strong> over fixed periods, <strong>produce the compounded amounts  of a deposit</strong> with fixed interest rate over years, ..., etc.</p>
<p>Two functions (shamelessly borrowed from Haskell):</p>
<ul>
<li><strong>fn:scan-left</strong></li>
<li><strong>fn:scan-right</strong></li>
</ul>
<hr>
<h2>fn:scan-left</h2>
<p>This function has a similar signature to that of <strong><em><code>fn:fold-left</code></em></strong> and produces the same final result, however it produces the complete (ordered) sequence of all partial results from every new value the accumulator gets during the evaluation of <strong><em><code>fn:fold-left</code></em></strong>.</p>
<h3>Signature</h3>
<pre><code class="language-xq">fn:scan-left($input	as item()*,	
             $zero	as item()*,	
             $action	as function(item()*, item()) as item()*	
) as array(*)*
</code></pre>
<h3>Properties</h3>
<p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic">·deterministic·</a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent">·context-independent·</a>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent">·focus-independent·</a>.</p>
<h3>Rules</h3>
<p>The function is equivalent to the following implementation in XPath(return clause added for completeness):</p>
<pre><code class="language-xq">let $scan-left-inner := function($seq as item()*, 
                                 $zero as item(), 
                                 $fun as function(item()*, item()) as item()*,
                                 $self as function(*)
                               ) as array(*)*                               
{
  let $result := [$zero]
   return
     if(empty($seq)) then $result
       else
         (
           $result, $self(tail($seq), $fun($zero, head($seq)), $fun, $self)  
         )
},

$scan-left := function($seq as item()*, 
                       $zero as item(), 
                       $fun as function(item()*, item()) as item()*
                     ) as array(*)*  
{
  $scan-left-inner($seq, $zero, $fun, $scan-left-inner)
}  

  return
    $scan-left(1 to 10, 0, op('+'))
</code></pre>
<h3>Examples:</h3>
<pre><code class="language-xq"> $scan-left(1 to 10, 0, op('+'))
</code></pre>
<p>produces:</p>
<pre><code class="language-xq">[0]
[1]
[3]
[6]
[10]
[15]
[21]
[28]
[36]
[45]
[55]
</code></pre>
<p><img src="https://github.com/qt4cg/qtspecs/assets/10605892/603c0584-31bb-431f-b928-875058111128" alt="image"></p>
<h2>fn:scan-right</h2>
<p>This function has a similar signature to that of <strong><em><code>fn:fold-right</code></em></strong> and produces the same final result, however it produces the complete (ordered) sequence of all partial results from every new value the accumulator gets during the evaluation of <strong><em><code>fn:fold-right</code></em></strong>.</p>
<h3>Signature</h3>
<pre><code class="language-xq">fn:scan-right($input	as item()*,	
              $zero	as item()*,	
              $action	as function(item()*, item()) as item()*	
) as array(*)*
</code></pre>
<h3>Properties</h3>
<p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic">·deterministic·</a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent">·context-independent·</a>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent">·focus-independent·</a>.</p>
<h3>Rules</h3>
<p>The function is equivalent to the following implementation in XPath(return clause added for completeness):</p>
<pre><code class="language-xq">let  $scan-right-inner := function($seq as item()*,
                                   $zero as item()*,
                                   $f as function(item(), item()*) as item()*,                          
                                   $self as function(*)
                                  ) as array(*)*
{
    if(empty($seq)) then [$zero]
      else
        let $rightResult := $self(tail($seq), $zero, $f, $self)
         return
            ([$f(head($seq), head($rightResult))], $rightResult)
},

$scan-right := function($seq as item()*,
                        $zero as item()*,
                        $f as function(item(), item()*) as item()*
                       ) as array(*)*
{
  $scan-right-inner($seq, $zero, $f, $scan-right-inner)
}   

return
  $scan-right(1 to 10, 0, op('+'))  
</code></pre>
<h3>Examples:</h3>
<pre><code class="language-xq"> $scan-right(1 to 10, 0, op('+'))
</code></pre>
<p>produces:</p>
<pre><code class="language-xq">[55]
[54]
[52]
[49]
[45]
[40]
[34]
[27]
[19]
[10]
[0]
</code></pre>
<p><img src="https://github.com/qt4cg/qtspecs/assets/10605892/68f5010d-133d-4bcf-8096-609a3d26697f" alt="image"></p>
</div></details></div>
<div class="toot" id="agenda-01-16"><h2>QT4 CG meeting 061 draft agenda<span class="toot-id"> #agenda-01-16</span></h2><div class="pubdate">15 Jan at 14:40:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/01-16">https://qt4cg.org/meeting/agenda/2024/01-16</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-899"><h2>Issue #899 closed<span class="toot-id"> #closed-899</span></h2><div class="pubdate">15 Jan at 15:21:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/899">https://github.com/qt4cg/qtspecs/issues/899</a></div><p>Simplifying the language - types have behaviour.</p></div>
<div class="toot" id="created-947"><h2>Pull request #947 created<span class="toot-id"> #created-947</span></h2><div class="pubdate">15 Jan at 10:39:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/947">https://github.com/qt4cg/qtspecs/pull/947</a></div><details><summary>Reorganise F+O chapter 15 [editorial]</summary><div class="markup"><p>This PR reorganizes the subsections of F+O chapter 15 (the XML/HTML/JSON/CSV/IXML chapter). There is no change to content apart from a couple of introductory sentences. I'm planning to do some fine-grained work on the content in due course, but to make that easier to review it seems best to do the top-level reorganisation first. I'm therefore hoping that this PR will go through quickly "on the nod" so I can use it as a baseline for the detail changes.</p>
</div></details></div>
<div class="toot" id="created-946"><h2>Issue #946 created<span class="toot-id"> #created-946</span></h2><div class="pubdate">12 Jan at 16:10:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/946">https://github.com/qt4cg/qtspecs/issues/946</a></div><details><summary>fn:iterate-while → fn:while-do, fn:do-until</summary><div class="markup"><p>First feedback shows that <code>fn:iterate-while</code> is helpful, but the name needs to be improved: It implies that the first iteration occurs before the invocation of the test… Which could sometimes be helpful, too.</p>
<p>I suggest renaming the function to <code>fn:while-do</code> (“do” is commonly used when while loops are specified), and adding <code>fn:do-until</code>.</p>
</div></details></div>
<div class="toot" id="created-945"><h2>Issue #945 created<span class="toot-id"> #created-945</span></h2><div class="pubdate">12 Jan at 15:41:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/945">https://github.com/qt4cg/qtspecs/issues/945</a></div><details><summary>Module import: apparent contradiction</summary><div class="markup"><p>XQuery 5.12 paragraph 2 says:</p>
<blockquote>
<p>If a module A imports module B, the static context of module A will contain the [in-scope schema definitions]... of module B.</p>
</blockquote>
<p>Paragraph 10 says:</p>
<blockquote>
<p>A [module import] imports only functions, variable declarations, and item type declaratons; it does not import other objects from the imported modules, such as [in-scope schema definitions] or [statically known namespaces].</p>
</blockquote>
<p>They can't both be right, surely?</p>
</div></details></div>
<div class="toot" id="created-944"><h2>Issue #944 created<span class="toot-id"> #created-944</span></h2><div class="pubdate">12 Jan at 11:18:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/944">https://github.com/qt4cg/qtspecs/issues/944</a></div><details><summary>Coercion rules: implicit types</summary><div class="markup"><p>Since 2.0, the coercion rules (formerly function conversion rules) have allowed implicit conversion from decimal to double, decimal to float, and float to double on function calls; other conversions such as double to decimal or float to decimal are not allowed. This has never made very much sense because in some implementations, decimal to float is a lossy conversion whereas float to decimal is not.</p>
<p>One option would be to allow conversion from any numeric type to any other.</p>
<p>The main caveat here is that I don't think it makes sense to allow a double such as 1.5e0 to be supplied where the required type is xs:integer. We have introduced new conversions that make it possible to supply a decimal where an integer is expected, but only if the decimal is in the value space of integer.</p>
<p>A possible formulation would be:</p>
<p>If the required type is a numeric type (that is, xs:decimal, xs:double, xs:float, or any type derived from these), and if the supplied value is a numeric value, then the supplied value is cast to the required primitive type, and if the result is in the value space of the actual required type it is then relabelled as an instance of the actual required type (if not, the conversion fails).</p>
<p>This means that supplying 1.0e0 for an argument expecting xs:integer (or xs:positiveInteger, etc) would work (it would cast to xs:decimal and then relabel as xs:integer), but supplying 1.1e0 would fail.</p>
</div></details></div>
<div class="toot" id="created-943"><h2>Pull request #943 created<span class="toot-id"> #created-943</span></h2><div class="pubdate">11 Jan at 10:28:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/943">https://github.com/qt4cg/qtspecs/pull/943</a></div><details><summary>187 Add FLWOR expression while clause</summary><div class="markup"><p>Fix #187</p>
</div></details></div>
<div class="toot" id="created-942"><h2>Pull request #942 created<span class="toot-id"> #created-942</span></h2><div class="pubdate">10 Jan at 16:42:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/942">https://github.com/qt4cg/qtspecs/pull/942</a></div><details><summary>530 Fix typo, escape-solidus not escape-uri-attributes</summary><div class="markup"><p>Fix #530.</p>
<p>On half a dozen occasions, <code>escape-uri-attributes</code> is used where <code>escape-solidus</code> is clearly intended.</p>
</div></details></div>
<div class="toot" id="closed-886"><h2>Issue #886 closed<span class="toot-id"> #closed-886</span></h2><div class="pubdate">10 Jan at 14:28:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/886">https://github.com/qt4cg/qtspecs/issues/886</a></div><p>Binary map keys</p></div>
<div class="toot" id="created-941"><h2>Pull request #941 created<span class="toot-id"> #created-941</span></h2><div class="pubdate">10 Jan at 12:20:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/941">https://github.com/qt4cg/qtspecs/pull/941</a></div><details><summary>939 Remove fn:numeric-compare</summary><div class="markup"><p>Issue: #939</p>
</div></details></div>
<div class="toot" id="created-940"><h2>Pull request #940 created<span class="toot-id"> #created-940</span></h2><div class="pubdate">10 Jan at 12:05:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/940">https://github.com/qt4cg/qtspecs/pull/940</a></div><details><summary>878 Add subsequence-where function</summary><div class="markup"><p>Supersedes PR #874</p>
<p>Following discussion of PR #874 which proposed an extended subsequence() function with options to define the start and end position by predicates, this new PR proposes instead a subsequence-where() function that allows the start and end position to be defined by predicates, leaving the existing subsequence() function unchanged.</p>
<p>The items-before/after/starting-where/ending-where quartet are dropped.</p>
<p>The new function is inclusive at both ends. To start at the item after the one that matches the start condition, apply tail() to the result. To finish before the item that matches the end condition, apply trunk() to the result.</p>
</div></details></div>
<div class="toot" id="closed-893"><h2>Issue #893 closed<span class="toot-id"> #closed-893</span></h2><div class="pubdate">10 Jan at 11:55:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/893">https://github.com/qt4cg/qtspecs/issues/893</a></div><p>fn:compare: Support for arbitrary atomic types</p></div>
<div class="toot" id="closed-918"><h2>Issue #918 closed<span class="toot-id"> #closed-918</span></h2><div class="pubdate">10 Jan at 09:19:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/918">https://github.com/qt4cg/qtspecs/pull/918</a></div><p>Minor cx through chap. 14</p></div>
<div class="toot" id="created-939"><h2>Issue #939 created<span class="toot-id"> #created-939</span></h2><div class="pubdate">10 Jan at 09:12:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/939">https://github.com/qt4cg/qtspecs/issues/939</a></div><details><summary>Remove fn:numeric-compare</summary><div class="markup"><p>Related action: <a href="https://qt4cg.org/meeting/minutes/2024/01-09.html">QT4CG-060-04</a></p>
<p>@michaelhkay I proposed to merge <code>fn:numeric-compare</code> into <code>fn:compare</code> in #866; your response was:</p>
<blockquote>
<p>Folding fn:numeric-compare into fn:compare is more feasible, but you've then got one function that does two different jobs; there's no type safety to ensure that the arguments have compatible types, and you need ad-hoc rules to say which combinations of arguments are valid and which aren't. The merit of two separate functions is that each is a total function over the domain implied by its signature.</p>
</blockquote>
<p>Do you think the concerns are still relevant, or should we tackle this?</p>
</div></details></div>
<div class="toot" id="created-938"><h2>Issue #938 created<span class="toot-id"> #created-938</span></h2><div class="pubdate">10 Jan at 04:30:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/938">https://github.com/qt4cg/qtspecs/issues/938</a></div><details><summary>Canonical serialization</summary><div class="markup"><p>This issue picks up suggestions from #779 regarding canonical serialization, and solicits from the community group input on if such a function is desirable, and what such a function might look like.</p>
<p>In the context of #779, the idea was that two XML documents with different physical representations, but semantically equivalent, could be serialized to a canonical form, with a hash value applied to each confirming identity. Of course, with canonical operation, a simple string comparison would be sufficient, absent any hashing.</p>
<p>XML Signature was suggested as one approach, with some hesitation. I would like to suggest, instead, that we look to implement <a href="https://www.w3.org/TR/xml-c14n/">Canonical XML Version 1.1</a> (herein <strong>CX1.1</strong>), perhaps with map options that calibrate how CX1.1 is implemented. I have no experience using CX1.1, so user input is welcome.</p>
<p>Another point of discussion is whether this merits a new function, e.g., <code>fn:canonical-serialize</code>, or should be built upon <code>fn:serialize</code>. A problem with the latter option, is that such an approach makes no sense without the <code>method</code> option specified as <code>xml</code>. Another approach would be to go deeper, into the serialization spec, and expand the <code>xml</code> method to ensure a canonical option.</p>
<p>I believe that this function would be extremely useful. When preparing test suites, output could be saved as secondary documents as canonical XML, and any subsequent regression tests could adjust comparanda to canonical XML, and very precise node-wise comparisons could be made.</p>
<p>I look forward to everyone's input.</p>
</div></details></div>
<div class="toot" id="created-937"><h2>Pull request #937 created<span class="toot-id"> #created-937</span></h2><div class="pubdate">10 Jan at 04:03:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/937">https://github.com/qt4cg/qtspecs/pull/937</a></div><details><summary>779 hash function</summary><div class="markup"><p>First draft of hash function, proposed in #779.</p>
<p>Error message left as to-do item; guidance from editors appreciated.</p>
<p>I opted to leave out wrapper/cryptographic functionality, such as salting, and to demonstrate via example how it could be done by a developer on their own. In my opinion what we need here is a simple atomic function that can be incorporated into other molecular functions.</p>
<p>I may tinker with the prose description up to CG discussion, so comments are welcome.</p>
</div></details></div>
<div class="toot" id="created-936"><h2>Pull request #936 created<span class="toot-id"> #created-936</span></h2><div class="pubdate">10 Jan at 02:30:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/936">https://github.com/qt4cg/qtspecs/pull/936</a></div><details><summary>877 revised rules for op:binary-less-than</summary><div class="markup"><p>Rule 3 for <code>op:binary-less-than</code> was a bit of a mess (see #877), and needed to be expressed as a recursive operation.</p>
<p>My proposed revision depends of phraseology drawn from <code>fn:decode-from-uri</code>, <code>fn:deep-equal</code>, and 5.3.2 Unicode Codepoint Collation (here slightly adjusted from unordered to ordered list).</p>
</div></details></div>
<div class="toot" id="closed-876"><h2>Issue #876 closed<span class="toot-id"> #closed-876</span></h2><div class="pubdate">10 Jan at 01:24:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/876">https://github.com/qt4cg/qtspecs/issues/876</a></div><p>Placement of fn:in-scope-namespaces(), fn:in-scope-prefixes(), fn:namespace-uri-for-prefix()</p></div>
<div class="toot" id="closed-909"><h2>Issue #909 closed<span class="toot-id"> #closed-909</span></h2><div class="pubdate">09 Jan at 17:54:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/909">https://github.com/qt4cg/qtspecs/pull/909</a></div><p>893 fn:compare: Support for arbitrary atomic types</p></div>
<div class="toot" id="closed-860"><h2>Issue #860 closed<span class="toot-id"> #closed-860</span></h2><div class="pubdate">09 Jan at 17:51:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/860">https://github.com/qt4cg/qtspecs/issues/860</a></div><p>Unary Lookup when the context value is a sequence</p></div>
<div class="toot" id="closed-926"><h2>Issue #926 closed<span class="toot-id"> #closed-926</span></h2><div class="pubdate">09 Jan at 17:51:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/926">https://github.com/qt4cg/qtspecs/pull/926</a></div><p>860 Editorial rearrangement of spec for shallow lookup</p></div>
<div class="toot" id="closed-780"><h2>Issue #780 closed<span class="toot-id"> #closed-780</span></h2><div class="pubdate">09 Jan at 17:42:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/780">https://github.com/qt4cg/qtspecs/issues/780</a></div><p>format-number() etc incompatibility</p></div>
<div class="toot" id="closed-925"><h2>Issue #925 closed<span class="toot-id"> #closed-925</span></h2><div class="pubdate">09 Jan at 17:42:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/925">https://github.com/qt4cg/qtspecs/pull/925</a></div><p>780 Document incompatibility in format-number etc</p></div>
<div class="toot" id="closed-935"><h2>Issue #935 closed<span class="toot-id"> #closed-935</span></h2><div class="pubdate">09 Jan at 17:41:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/935">https://github.com/qt4cg/qtspecs/pull/935</a></div><p>Fix the fo test catalog</p></div>
<div class="toot" id="created-935"><h2>Pull request #935 created<span class="toot-id"> #created-935</span></h2><div class="pubdate">09 Jan at 17:41:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/935">https://github.com/qt4cg/qtspecs/pull/935</a></div><details><summary>Fix the fo test catalog</summary><div class="markup"><p>A duplicate name was introduced.</p>
</div></details></div>
<div class="toot" id="closed-648"><h2>Issue #648 closed<span class="toot-id"> #closed-648</span></h2><div class="pubdate">09 Jan at 17:36:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/648">https://github.com/qt4cg/qtspecs/issues/648</a></div><p>Schema for FN namespace should block extension and substitution</p></div>
<div class="toot" id="closed-924"><h2>Issue #924 closed<span class="toot-id"> #closed-924</span></h2><div class="pubdate">09 Jan at 17:36:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/924">https://github.com/qt4cg/qtspecs/pull/924</a></div><p>648 Disallow user modifications to schema for FN namespace</p></div>
<div class="toot" id="closed-913"><h2>Issue #913 closed<span class="toot-id"> #closed-913</span></h2><div class="pubdate">09 Jan at 17:30:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/913">https://github.com/qt4cg/qtspecs/issues/913</a></div><p>XQFO: under/unused variable apparatus</p></div>
<div class="toot" id="closed-923"><h2>Issue #923 closed<span class="toot-id"> #closed-923</span></h2><div class="pubdate">09 Jan at 17:30:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/923">https://github.com/qt4cg/qtspecs/pull/923</a></div><p>913-new-examples-for-local-name-etc</p></div>
<div class="toot" id="closed-915"><h2>Issue #915 closed<span class="toot-id"> #closed-915</span></h2><div class="pubdate">09 Jan at 17:27:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/915">https://github.com/qt4cg/qtspecs/issues/915</a></div><p>[Editorial] Incorrect terminology: function implementation is now function body</p></div>
<div class="toot" id="closed-922"><h2>Issue #922 closed<span class="toot-id"> #closed-922</span></h2><div class="pubdate">09 Jan at 17:27:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/922">https://github.com/qt4cg/qtspecs/pull/922</a></div><p>915 function body terminology</p></div>
<div class="toot" id="closed-914"><h2>Issue #914 closed<span class="toot-id"> #closed-914</span></h2><div class="pubdate">09 Jan at 17:23:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/914">https://github.com/qt4cg/qtspecs/pull/914</a></div><p>XQFO minor edits</p></div>
<div class="toot" id="closed-912"><h2>Issue #912 closed<span class="toot-id"> #closed-912</span></h2><div class="pubdate">09 Jan at 17:20:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/912">https://github.com/qt4cg/qtspecs/pull/912</a></div><p>XQFO: Minor edits</p></div>
<div class="toot" id="closed-906"><h2>Issue #906 closed<span class="toot-id"> #closed-906</span></h2><div class="pubdate">09 Jan at 17:17:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/906">https://github.com/qt4cg/qtspecs/issues/906</a></div><p>fn:deep-equal: unordered → ordered</p></div>
<div class="toot" id="closed-907"><h2>Issue #907 closed<span class="toot-id"> #closed-907</span></h2><div class="pubdate">09 Jan at 17:17:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/907">https://github.com/qt4cg/qtspecs/pull/907</a></div><p>906 fn:deep-equal: unordered → ordered</p></div>
<div class="toot" id="closed-898"><h2>Issue #898 closed<span class="toot-id"> #closed-898</span></h2><div class="pubdate">09 Jan at 17:14:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/898">https://github.com/qt4cg/qtspecs/issues/898</a></div><p>Drop the requirement for document-uri() uniqueness</p></div>
<div class="toot" id="closed-905"><h2>Issue #905 closed<span class="toot-id"> #closed-905</span></h2><div class="pubdate">09 Jan at 17:14:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/905">https://github.com/qt4cg/qtspecs/pull/905</a></div><p>898 - relax the constraints on document-uri</p></div>
<div class="toot" id="closed-821"><h2>Issue #821 closed<span class="toot-id"> #closed-821</span></h2><div class="pubdate">09 Jan at 17:11:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/821">https://github.com/qt4cg/qtspecs/issues/821</a></div><p>Annotations: Make default namespace explicit</p></div>
<div class="toot" id="closed-904"><h2>Issue #904 closed<span class="toot-id"> #closed-904</span></h2><div class="pubdate">09 Jan at 17:11:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/904">https://github.com/qt4cg/qtspecs/pull/904</a></div><p>821 Annotations: Make default namespace explicit</p></div>
<div class="toot" id="closed-895"><h2>Issue #895 closed<span class="toot-id"> #closed-895</span></h2><div class="pubdate">09 Jan at 17:07:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/895">https://github.com/qt4cg/qtspecs/issues/895</a></div><p>Parameters with default values: allow empty sequences</p></div>
<div class="toot" id="closed-901"><h2>Issue #901 closed<span class="toot-id"> #closed-901</span></h2><div class="pubdate">09 Jan at 17:07:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/901">https://github.com/qt4cg/qtspecs/pull/901</a></div><p>895 Parameters with default values: allow empty sequences</p></div>
<div class="toot" id="created-934"><h2>Issue #934 created<span class="toot-id"> #created-934</span></h2><div class="pubdate">08 Jan at 18:00:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/934">https://github.com/qt4cg/qtspecs/issues/934</a></div><details><summary>String comparison in deep-equal</summary><div class="markup"><p>The code showing how strings should be compared in deep-equal has gone awry, it doesn't match the prose. In equal-strings(), the lines</p>
<pre><code>let $n1 := if ($options?whitespace = "normalize"))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  let $n2 := if ($options?normalize-space)
             then normalize-space#1 
             else identity#1      
</code></pre>
<p>should read:</p>
<pre><code>let $n1 := if ($options?whitespace = 'normalize')
             then normalize-space#1 
             else identity#1    
let $n2 := if ($options?normalization-form))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  
</code></pre>
<p>Actually, the whole thing can now be expressed more concisely using fn:chain:</p>
<pre><code>declare function equal-strings(
  $string1   as xs:string,
  $string2   as xs:string, 
  $collation as xs:string,
  $options   as map(*)
) as xs:boolean {
  let $norm := fn:chain(?,
                        (normalize-unicode(?, $options?normalization-form)[$options?whitespace = "normalize"],
                         normalize-space#1[$options?normalize-space]))          
  return compare($norm($string1), $norm($string2), $collation) eq 0    
}
</code></pre>
</div></details></div>
<div class="toot" id="created-933"><h2>Pull request #933 created<span class="toot-id"> #created-933</span></h2><div class="pubdate">08 Jan at 12:49:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/933">https://github.com/qt4cg/qtspecs/pull/933</a></div><details><summary>930 drop obsolete note about comments and PIs</summary><div class="markup"><p>Fix #930</p>
<p>The note is obsolete because adjacent text nodes are now combined after stripping comments and PIs.</p>
</div></details></div>
<div class="toot" id="created-932"><h2>Pull request #932 created<span class="toot-id"> #created-932</span></h2><div class="pubdate">08 Jan at 12:42:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/932">https://github.com/qt4cg/qtspecs/pull/932</a></div><details><summary>931 Add rules for duration precision</summary><div class="markup"><p>Fix #931</p>
<p>Adds rules for the precision of durations and operations on durations, analogous to the existing rules for dates/times.</p>
</div></details></div>
<div class="toot" id="created-931"><h2>Issue #931 created<span class="toot-id"> #created-931</span></h2><div class="pubdate">07 Jan at 10:21:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/931">https://github.com/qt4cg/qtspecs/issues/931</a></div><details><summary>Precision of duration arithmetic</summary><div class="markup"><p>We specify that dates/times are manipulated at least to millisecond precision, but we have no similar statement for durations.</p>
<p>See https://stackoverflow.com/questions/77752844</p>
<p>michael.hor257k points out:</p>
<blockquote>
<p>The 2.0 specification states: "The result is obtained by casting $arg to an xs:dayTimeDuration ... and then computing the seconds component as described in 10.3.2.3 Canonical representation." And then: "The canonical representation of xs:dayTimeDuration restricts ... the value of the seconds component to xs:decimal valued from 0.0 to 59.999... ", with reference to XML Schema Part 2: Datatypes which mandates "a minimum fractional second precision of milliseconds or three decimal digits". None of this appears in the 3.0 spec, though the examples still show a decimal digit being extracted. –</p>
</blockquote>
</div></details></div>
<div class="toot" id="closed-929"><h2>Issue #929 closed<span class="toot-id"> #closed-929</span></h2><div class="pubdate">07 Jan at 10:19:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/929">https://github.com/qt4cg/qtspecs/issues/929</a></div><p>map:values() - Would it be better to return an array?</p></div>
<div class="toot" id="created-930"><h2>Issue #930 created<span class="toot-id"> #created-930</span></h2><div class="pubdate">06 Jan at 17:13:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/930">https://github.com/qt4cg/qtspecs/issues/930</a></div><details><summary>Obsolete comment under fn:deep-equal()</summary><div class="markup"><p>The notes for fn:deep-equal() include the paragraph:</p>
<blockquote>
<p>By default, the contents of comments and processing instructions are significant only if these nodes appear directly as items in the two sequences being compared. The content of a comment or processing instruction that appears as a descendant of an item in one of the sequences being compared does not affect the result. However, the presence of a comment or processing instruction, if it causes a text node to be split into two text nodes, may affect the result.</p>
</blockquote>
<p>This is no longer true: we fixed it so that adjacent text nodes are merged after stripping comments and PIs.</p>
</div></details></div>
<div class="toot" id="created-929"><h2>Issue #929 created<span class="toot-id"> #created-929</span></h2><div class="pubdate">06 Jan at 08:34:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/929">https://github.com/qt4cg/qtspecs/issues/929</a></div><details><summary>map:values() - Would it be better to return an array?</summary><div class="markup"><p>The new function <code>map:values()</code> returns the values present in a map, flattened into a sequence.</p>
<p>This loses information if the values are not all singletons.</p>
<p>Would it be better to return an array?</p>
<p>That is, to return <code>array:build(map:pairs($map), fn{?value}))</code></p>
</div></details></div>
<div class="toot" id="created-928"><h2>Pull request #928 created<span class="toot-id"> #created-928</span></h2><div class="pubdate">06 Jan at 02:47:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/928">https://github.com/qt4cg/qtspecs/pull/928</a></div><details><summary>Minor edits through ch. 15</summary><div class="markup"><p>Light edits here for consistency, clarity. I didn't touch the CSV prose much, knowing it is subject to major revisions.</p>
</div></details></div>
<div class="toot" id="created-927"><h2>Pull request #927 created<span class="toot-id"> #created-927</span></h2><div class="pubdate">04 Jan at 18:14:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/927">https://github.com/qt4cg/qtspecs/pull/927</a></div><details><summary>861 Rewrite spec of deep lookup operator</summary><div class="markup"><p>Fix #861</p>
<p>This is a complete rewrite of the spec for deep-lookup, hopefully clarifying some edge cases and fixing bugs, but not intended to introduce any major changes.</p>
</div></details></div>
<div class="toot" id="created-926"><h2>Pull request #926 created<span class="toot-id"> #created-926</span></h2><div class="pubdate">04 Jan at 12:55:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/926">https://github.com/qt4cg/qtspecs/pull/926</a></div><details><summary>860 Editorial rearrangement of spec for shallow lookup</summary><div class="markup"><p>Rearranges the spec for lookup expressions so that unary lookup is now defined in terms of postfix lookup, not the other way around; this simplifies the rules when the context value is not a singleton, or when the key specifier expression is context-dependent.</p>
<p>Fix #860</p>
</div></details></div>
<div class="toot" id="created-925"><h2>Pull request #925 created<span class="toot-id"> #created-925</span></h2><div class="pubdate">03 Jan at 23:39:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/925">https://github.com/qt4cg/qtspecs/pull/925</a></div><details><summary>780 Document incompatibility in format-number etc</summary><div class="markup"><p>Fix #780</p>
<p>Changes the XSLT and F+O specs to document a minor incompatibility arising from the change to functions such as <code>format-number()</code> to accept an argument of type <code>union(xs:string, xs:QName)</code> rather than <code>xs:string</code>.</p>
<p>In addition, in XSLT, all such functions now accept <code>union(xs:string, xs:QName)</code> rather than <code>union(xs:QName, xs:string)</code>. This is primarily to make them all consistent.</p>
</div></details></div>
<div class="toot" id="created-924"><h2>Pull request #924 created<span class="toot-id"> #created-924</span></h2><div class="pubdate">03 Jan at 19:59:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/924">https://github.com/qt4cg/qtspecs/pull/924</a></div><details><summary>648 Disallow user modifications to schema for FN namespace</summary><div class="markup"><p>Fix #648</p>
</div></details></div>
<div class="toot" id="closed-889"><h2>Issue #889 closed<span class="toot-id"> #closed-889</span></h2><div class="pubdate">03 Jan at 19:34:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/889">https://github.com/qt4cg/qtspecs/issues/889</a></div><p>Rename "Named Function Reference"</p></div>
<div class="toot" id="created-923"><h2>Pull request #923 created<span class="toot-id"> #created-923</span></h2><div class="pubdate">02 Jan at 23:02:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/923">https://github.com/qt4cg/qtspecs/pull/923</a></div><details><summary>913-new-examples-for-local-name-etc</summary><div class="markup"><p>I have created new (executable) examples for functions name, local-name, namespace-uri, node-name, count, number.</p>
<p>There are of course many other functions that would benefit from the same treatment.</p>
<p>Fix #913</p>
</div></details></div>
<div class="toot" id="created-922"><h2>Pull request #922 created<span class="toot-id"> #created-922</span></h2><div class="pubdate">01 Jan at 21:23:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/922">https://github.com/qt4cg/qtspecs/pull/922</a></div><details><summary>915 function body terminology</summary><div class="markup"><p>Fix #915</p>
</div></details></div>
<div class="toot" id="created-921"><h2>Pull request #921 created<span class="toot-id"> #created-921</span></h2><div class="pubdate">01 Jan at 20:14:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/921">https://github.com/qt4cg/qtspecs/pull/921</a></div><details><summary>920 Allow xsl:break and xsl:next-iteration within branch of xsl:switch</summary><div class="markup"><p>Allow xsl:break and xsl:next-iteration within branch of xsl:switch</p>
<p>Fix #920</p>
</div></details></div></div></article></main></body></html>