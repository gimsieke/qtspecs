<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="created-1113"><h2>Issue #1113 created<span class="toot-id"> #created-1113</span></h2><div class="pubdate">25 Mar at 10:40:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1113">https://github.com/qt4cg/qtspecs/issues/1113</a></div><details><summary>Misleading rendering BiDi text in parse-integer example</summary><div class="markup"><p>In fuction index one example of fn:parse-integer() is using parameters containing arabic letters. This leads to wrong display of parameters as 1st and 2nd parameter look like switched because browser renders both of them from left to right. It is this example:</p>
<pre><code>&lt;fos:test&gt;
               &lt;fos:expression&gt;&lt;eg&gt;translate('٢٠٢٣', '٠١٢٣٤٥٦٧٨٩', '0123456789')
=&gt; parse-integer()&lt;/eg&gt;&lt;/fos:expression&gt;
               &lt;fos:result&gt;2023&lt;/fos:result&gt;
            &lt;/fos:test&gt;
</code></pre>
<p>This looks confusing. I don't know what will be the best fix. Maybe storing '٠١٢٣٤٥٦٧٨٩' into variable would help and prevent the issue.</p>
</div></details></div>
<div class="toot" id="created-1112"><h2>Pull request #1112 created<span class="toot-id"> #created-1112</span></h2><div class="pubdate">25 Mar at 08:15:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1112">https://github.com/qt4cg/qtspecs/pull/1112</a></div><details><summary>1110-partial New error codes</summary><div class="markup"><p>Issue: #1110.</p>
<ul>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview-diff.html#func-hash">fn:hash</a>: I added <code>FOHA0001</code> as error code.</li>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview-diff.html#func-op">fn:op</a>: I used <code>XPTY0004</code> as error code, as the allowed operators could also be defined as string enumeration.</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xquery-40-diff.html#id-map-test">XQuery, Map Test</a>: Not included in this PR.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1111"><h2>Issue #1111 created<span class="toot-id"> #created-1111</span></h2><div class="pubdate">24 Mar at 08:40:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1111">https://github.com/qt4cg/qtspecs/issues/1111</a></div><details><summary>xsl:pipeline</summary><div class="markup"><p>In XSLT 3.0 it is not possible to write a multi-phase streaming transformation, where two are more phases each operate in streaming mode and the result of one phase is piped into the next. Such transformations can only be written as multiple stylesheets, coordinated by some calling application.</p>
<p>A non-streamed multiphase transformation typically uses variables for the intermediate results:</p>
<pre><code>&lt;xsl:variable name="temp1"&gt;
   &lt;xsl:apply-templates mode="phase1"/&gt;
&lt;/xsl:variable&gt;
&lt;xsl:variable name="temp2"&gt;
   &lt;xsl:apply-templates select="$temp1" mode="phase2"/&gt;
&lt;/xsl:variable&gt;
&lt;xsl:apply-templates select="$temp2"/&gt;
</code></pre>
<p>This cannot be streamed because variables cannot hold streamed nodes.</p>
<p>The idea is to allow this to be written:</p>
<pre><code>&lt;xsl:pipeline streamable="yes"&gt;
   &lt;xsl:apply-templates mode="phase1"/&gt;
   &lt;xsl:apply-templates select="." mode="phase2"/&gt;
   &lt;xsl:apply-templates select="." mode="phase3"/&gt;
&lt;/xsl:pipeline&gt;
</code></pre>
<p>where each instruction in the pipeline takes as its context value the result of the previous instruction.</p>
<p>Even when no streaming is involved, the xsl:pipeline instruction brings usability benefits: it's much clearer to the reader what is going on.</p>
<p>(Triggered by a support request from a user wanting to make an existing pipelined transformation streamable; but the idea was considered and "postponed to v.next" during XSLT 3.0 development. The replacement of "context item" by "context value" removes one of the obstacles.)</p>
</div></details></div>
<div class="toot" id="created-1110"><h2>Issue #1110 created<span class="toot-id"> #created-1110</span></h2><div class="pubdate">23 Mar at 17:40:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1110">https://github.com/qt4cg/qtspecs/issues/1110</a></div><details><summary>New error codes</summary><div class="markup"><p>The XQFO spec includes various “[TODO: error code]” comments. Should we add error codes when finalizing PRs, or does a master plan exist to add them at the very end?</p>
</div></details></div>
<div class="toot" id="created-1109"><h2>Issue #1109 created<span class="toot-id"> #created-1109</span></h2><div class="pubdate">23 Mar at 15:46:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1109">https://github.com/qt4cg/qtspecs/issues/1109</a></div><details><summary>Discrepancies in fn:hash() published examples</summary><div class="markup"><p>In the third example:</p>
<p><code>hash("") </code></p>
<p>the expected result has a spurious trailing letter "o". That's trivial and I will fix it.</p>
<p>In the seventh example:</p>
<p><code>hash(serialize($doc), map{"algorithm": "sha-1"}) </code></p>
<p>I am getting a completely different result, which I suspect is because I am getting a different result from <code>serialize()</code>. Perhaps the difference is something like a trailing newline, I don't know.</p>
<p>In my case the result of <code>serialize($doc)</code> is the 14-character string <code>"&lt;doc&gt;abc&lt;/doc&gt;"</code>, which I believe is correct, but I suspect there might be other results of <code>serialize($doc)</code> that would also be conformant with the spec.</p>
</div></details></div>
<div class="toot" id="created-1108"><h2>Pull request #1108 created<span class="toot-id"> #created-1108</span></h2><div class="pubdate">22 Mar at 17:06:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1108">https://github.com/qt4cg/qtspecs/pull/1108</a></div><details><summary>566-partial Describe a less aggressive %-encoding for fn:build-uri</summary><div class="markup"><p>My proposal seemed to meet with general approval, so here is my attempt to implement it in the spec.</p>
</div></details></div>
<div class="toot" id="created-1107"><h2>Issue #1107 created<span class="toot-id"> #created-1107</span></h2><div class="pubdate">22 Mar at 16:27:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1107">https://github.com/qt4cg/qtspecs/issues/1107</a></div><details><summary>Grammar discrepancy on fn:pin() examples</summary><div class="markup"><p>I'm probably getting the wrong end of the stick, but I can't see how the example for <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-pin">fn:pin():</a></p>
<pre><code>pin(["a","b","c"])?1 =&gt; label()?parent =&gt; array:foot()
</code></pre>
<p>meets the current EBNF. (I know bits of this area may be in flux, so this may be just for the record .)</p>
<pre><code>pin(["a","b","c"])?1 =&gt; label()
</code></pre>
<p>meets the production for <code>ArrowExpr</code>, and the RHS of an <code>ArrowExpr</code> is, in this case, an <code>ArrowStaticFunction</code> <code>ArgumentList</code> pair, which doesn't encompass the subsequent lookup.</p>
<p>But for <code>LookupExpr</code> to include the <code>?parent</code> requires <code>PostfixExpr</code> as its first term, and <code>PostfixExpr</code> can only include <code>ArrowExpr</code> via <code>PrimaryExpr/ParenthesizedExpr</code>, i.e. with brackets.</p>
</div></details></div>
<div class="toot" id="closed-1052"><h2>Issue #1052 closed<span class="toot-id"> #closed-1052</span></h2><div class="pubdate">21 Mar at 12:51:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1052">https://github.com/qt4cg/qtspecs/issues/1052</a></div><p>parse-csv() - simplify output</p></div>
<div class="toot" id="created-1106"><h2>Pull request #1106 created<span class="toot-id"> #created-1106</span></h2><div class="pubdate">21 Mar at 12:41:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1106">https://github.com/qt4cg/qtspecs/pull/1106</a></div><details><summary>859 lookup syntax problems</summary><div class="markup"><p>Fix the syntax ambiguity identified in issue #859 by dropping the troublesome construct.</p>
<p>It is hoped something else will be introduced in its place.</p>
<p>Fix #859</p>
</div></details></div>
<div class="toot" id="created-1105"><h2>Issue #1105 created<span class="toot-id"> #created-1105</span></h2><div class="pubdate">21 Mar at 11:53:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1105">https://github.com/qt4cg/qtspecs/issues/1105</a></div><details><summary>Casting to numerical type from strings with underscores</summary><div class="markup"><p>The <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#prod-xpath40-Digits">Digits</a> production now permits underscores as separators in long numerical character sequences.
However in casting to numerical types, either by operator or by function:</p>
<pre><code>'12_345_678' as xs:integer
number('12.345_678')
</code></pre>
<p>am I correct that this should fail according to <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#casting-from-strings">Casting from xs:string and xs:untypedAtomic</a>, even though a static resolution/rewrite would be possible?</p>
</div></details></div>
<div class="toot" id="created-1104"><h2>Issue #1104 created<span class="toot-id"> #created-1104</span></h2><div class="pubdate">21 Mar at 10:06:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1104">https://github.com/qt4cg/qtspecs/issues/1104</a></div><details><summary>TypeTest expressions</summary><div class="markup"><p>Our current status quo text allows the result of a lookup expression to be filtered by type:</p>
<p><code>[[1,2], [3,4], 5, 6]?*::array(*)?1</code></p>
<p>and issue #859 points out that this doesn't work because of a syntax ambiguity involving occurrence indicators ('?' is both an occurrence indicator and a lookup operator).</p>
<p>This issue addresses that problem by re-examining the requirements, and pulling in a number of other issues at the same time.</p>
<p>In path expressions we have a shorthand syntax for selecting nodes, called the node test, and the proposed syntax <code>::array(*)</code> was modelled on this. Node tests have a considerable overlap with types, but there are limitations. For example the <code>self</code> axis is often used to turn a node test into a general predicate, but <code>[self::XX]</code> can only be used to test elements, not attributes. However, the popularity of node tests and the self axis illustrates the need for a concise filtering operation.</p>
<p>Of course it's always possible to write <code>[. instance of array(*)]</code> but this gets extremely verbose.</p>
<p>In XSLT 3.0, template rules matching maps and arrays could only be written as <code>match=".[. instance of array(*)]"</code>, which gets really ugly, so we have proposed an alternative in 4.0. Specifically, you can match any type using <code>match="type(ItemType)"</code>, and for many types such as arrays and maps you can abbreviate this to, for example <code>match="array(*)"</code>. But this feels clumsy because the type() wrapper is sometimes needed and sometimes not.</p>
<p>I would like to propose an expression that has concise syntax, whose effect is equivalent to <code>. instance of T</code>. I propose to use the <code>~</code> symbol. This is available as both a binary and unary operator, so we can define a binary form <code>$z ~ T</code> which is syntactic shorthand for <code>$z instance of T</code>, and a unary form <code>~T</code> which is shorthand for <code>. ~ T</code>.</p>
<p>First, in the case of lookup expressions, we can now write:</p>
<p><code>[[1,2], [3,4], 5, 6]?*[~array(*)]?1</code></p>
<p>TypeTests will often be used within predicates in this way, and of course the usage is completely general.</p>
<p>Here's an example used for array:filter: <code>array:filter($array, fn{~xs:integer+})</code> which selects all members of the array comprising one or more integers.</p>
<p>In XSLT 4.0 the syntax <code>~T</code> replaces the current TypePattern, giving a much more uniform way of matching items by type.</p>
<p>In XPath and XSLT conditionals the construct can be used as an equivalent to XQuery's TypeswitchExpr:</p>
<pre><code>&lt;xsl:choose&gt;
  &lt;xsl:when test="~xs:integer"&gt;...&lt;/xsl:when&gt;
  &lt;xsl:when test="~xs:string"&gt;...&lt;/xsl:when&gt;
  ...
&lt;/xsl:choose&gt;
</code></pre>
<p>The choice of tilde for this operator is motivated by:</p>
<ul>
<li>There are not many symbols available</li>
<li>Tilde has many different uses in mathematics and computing, some of which represent a boolean test applied to a value (for example testing whether it is similar to another value or whether it matches some pattern), which is not dissimilar to this proposed usage</li>
<li>The alliteration between "tilde" and "type" has some mnemonic value (cf. the use of <code>@</code> for the attribute axis).</li>
</ul>
</div></details></div>
<div class="toot" id="created-1103"><h2>Issue #1103 created<span class="toot-id"> #created-1103</span></h2><div class="pubdate">19 Mar at 18:24:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1103">https://github.com/qt4cg/qtspecs/issues/1103</a></div><details><summary>CSV Parsing - handling line ending normalization</summary><div class="markup"><p>During discussion of PR #1066 there was much debate about how best to handle normalization of (typically CRLF) line endings.</p>
<p>Perhaps it's very unlikely that CRLF line endings will make it as far as the parse-csv() function, because they will already have been normalized for example by unparsed-text(). But data can also be read in other ways, for example bin:read-binary() or sql:query() extension functions, or passed in as a string-valued parameter to a transformation.</p>
<p>Perhaps we should have a separate mechanism for normalizing line endings in any data, independent of CSV parsing? (But perhaps it's important to retain CRLF in quoted strings?)</p>
<p>Perhaps CSV parsing should normalise CRLF unconditionally, without needing to set a special option for it?</p>
</div></details></div>
<div class="toot" id="closed-1101"><h2>Issue #1101 closed<span class="toot-id"> #closed-1101</span></h2><div class="pubdate">19 Mar at 18:21:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1101">https://github.com/qt4cg/qtspecs/issues/1101</a></div><p>XQuery: Normalize line endings</p></div>
<div class="toot" id="closed-1089"><h2>Issue #1089 closed<span class="toot-id"> #closed-1089</span></h2><div class="pubdate">19 Mar at 17:49:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1089">https://github.com/qt4cg/qtspecs/issues/1089</a></div><p>Rounding when casting string to date/time or duration types</p></div>
<div class="toot" id="closed-1090"><h2>Issue #1090 closed<span class="toot-id"> #closed-1090</span></h2><div class="pubdate">19 Mar at 17:49:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1090">https://github.com/qt4cg/qtspecs/pull/1090</a></div><p>1089 Add rounding rules for casting string to duration etc</p></div>
<div class="toot" id="closed-1079"><h2>Issue #1079 closed<span class="toot-id"> #closed-1079</span></h2><div class="pubdate">19 Mar at 17:46:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1079">https://github.com/qt4cg/qtspecs/issues/1079</a></div><p>Editorial: XSLT, Applying Template Rules, Examples</p></div>
<div class="toot" id="closed-1083"><h2>Issue #1083 closed<span class="toot-id"> #closed-1083</span></h2><div class="pubdate">19 Mar at 17:46:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1083">https://github.com/qt4cg/qtspecs/pull/1083</a></div><p>1079 Change book used in example</p></div>
<div class="toot" id="closed-1050"><h2>Issue #1050 closed<span class="toot-id"> #closed-1050</span></h2><div class="pubdate">19 Mar at 17:43:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1050">https://github.com/qt4cg/qtspecs/issues/1050</a></div><p>Potential (low-risk) Ambiguities in XPath EBNF</p></div>
<div class="toot" id="closed-1081"><h2>Issue #1081 closed<span class="toot-id"> #closed-1081</span></h2><div class="pubdate">19 Mar at 17:43:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1081">https://github.com/qt4cg/qtspecs/pull/1081</a></div><p>1050 Fix ItemType grammar ambiguity</p></div>
<div class="toot" id="closed-1080"><h2>Issue #1080 closed<span class="toot-id"> #closed-1080</span></h2><div class="pubdate">19 Mar at 17:40:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1080">https://github.com/qt4cg/qtspecs/pull/1080</a></div><p>1036 Rephrase the rules for number-parser with liberal JSON</p></div>
<div class="toot" id="closed-1036"><h2>Issue #1036 closed<span class="toot-id"> #closed-1036</span></h2><div class="pubdate">19 Mar at 17:40:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1036">https://github.com/qt4cg/qtspecs/issues/1036</a></div><p>parse-json: liberal parsing</p></div>
<div class="toot" id="closed-1102"><h2>Issue #1102 closed<span class="toot-id"> #closed-1102</span></h2><div class="pubdate">19 Mar at 17:40:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1102">https://github.com/qt4cg/qtspecs/pull/1102</a></div><p>Fix broken idref to escaped-crlf in test generation</p></div>
<div class="toot" id="created-1102"><h2>Pull request #1102 created<span class="toot-id"> #created-1102</span></h2><div class="pubdate">19 Mar at 17:40:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1102">https://github.com/qt4cg/qtspecs/pull/1102</a></div><details><summary>Fix broken idref to escaped-crlf in test generation</summary><div class="markup"><p>It appears that <code>escaped-crlf-3</code> might have been intended. @michaelhkay ?</p>
</div></details></div>
<div class="toot" id="closed-1073"><h2>Issue #1073 closed<span class="toot-id"> #closed-1073</span></h2><div class="pubdate">19 Mar at 17:33:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1073">https://github.com/qt4cg/qtspecs/pull/1073</a></div><p>XQFO (editorial)</p></div>
<div class="toot" id="closed-757"><h2>Issue #757 closed<span class="toot-id"> #closed-757</span></h2><div class="pubdate">19 Mar at 17:32:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/757">https://github.com/qt4cg/qtspecs/issues/757</a></div><p>Function families</p></div>
<div class="toot" id="closed-463"><h2>Issue #463 closed<span class="toot-id"> #closed-463</span></h2><div class="pubdate">19 Mar at 17:32:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/463">https://github.com/qt4cg/qtspecs/issues/463</a></div><p>fn:parts() - extract the parts of a (not-really) atomic value</p></div>
<div class="toot" id="closed-448"><h2>Issue #448 closed<span class="toot-id"> #closed-448</span></h2><div class="pubdate">19 Mar at 17:31:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/448">https://github.com/qt4cg/qtspecs/issues/448</a></div><p>Support extended dateTime formats of ISO-8601:2019?</p></div>
<div class="toot" id="closed-283"><h2>Issue #283 closed<span class="toot-id"> #closed-283</span></h2><div class="pubdate">19 Mar at 17:31:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/283">https://github.com/qt4cg/qtspecs/issues/283</a></div><p>Enumeration types</p></div>
<div class="toot" id="closed-218"><h2>Issue #218 closed<span class="toot-id"> #closed-218</span></h2><div class="pubdate">19 Mar at 17:31:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/218">https://github.com/qt4cg/qtspecs/issues/218</a></div><p>Function library for maps with composite keys: and thoughts on encapsulation</p></div>
<div class="toot" id="closed-119"><h2>Issue #119 closed<span class="toot-id"> #closed-119</span></h2><div class="pubdate">19 Mar at 17:31:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/119">https://github.com/qt4cg/qtspecs/issues/119</a></div><p>Allow a map's key value to be any sequence</p></div></div><p>See 2142
            more statuses in yearly archives.</p></article></main></body></html>