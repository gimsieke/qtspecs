<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="created-830"><h2>Issue #830 created<span class="toot-id"> #created-830</span></h2><div class="pubdate">12 Nov at 22:52:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/830">https://github.com/qt4cg/qtspecs/issues/830</a></div><details><summary>Revise appendix D.4 of F+O: Illustrative user-written functions</summary><div class="markup"><p>Many of the functions in this non-normative appendix are no longer needed, or can be expressed more concisely using new 4.0 language features.</p>
</div></details></div>
<div class="toot" id="created-829"><h2>Issue #829 created<span class="toot-id"> #created-829</span></h2><div class="pubdate">12 Nov at 09:42:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/829">https://github.com/qt4cg/qtspecs/issues/829</a></div><details><summary>fn:boolean: EBV support for more item types</summary><div class="markup"><p>In #817, it was discussed that the current EBV semantics have been inspired a lot by XPath 1.0. Today, we have numerous other data types apart from strings, doubles, booleans, and nodes, and I believe it’s time to do justice to this by getting rid of the error for unsupported data types for <code>fn:boolean</code>.</p>
<p>We currently have:</p>
<p>Type | Rule to compute boolean value
--- | ---
<code>node()</code> | <code>true()</code>
<code>xs:boolean</code> | <code>$item != 0 and not(is-NaN($item))</code>
<code>xs:untypedAtomic</code>, <code>xs:string</code>, <code>xs:anyURI</code> | <code>$item != ''</code></p>
<p>I have two options in mind:</p>
<ol>
<li>The easiest solution, which would come closest to JavaScript, would be to return <code>true()</code> for all other items. This would allow us to do simple checks like:</li>
</ol>
<pre><code class="language-xquery">declare function local:byte-length($data as xs:basexBinary?) xs:integer {
  (: instead of exists($data); utilizes the EXPath Binary Module :)
  if($data) then bin:length($data) else 0
};
</code></pre>
<ol start="2">
<li>If we want to be more fine granular, we could do justice to the specifics of 4 more types:</li>
</ol>
<p>Type | Rule to compute boolean value
--- | ---
<code>array(*)</code> | <code>array:size($item) != 0</code>
<code>map(*)</code> | <code>map:size($item) != 0</code>
<code>xs:base64Binary</code><br><code>xs:hex64Binary</code> | <code>bin:length($item) != 0</code> or <br><code>not($item = (xs:hexBinary(''), xs:base64Binary(''))</code></p>
<p>It would then be possible to write:</p>
<ul>
<li><code>if($map)</code> instead of <code>map:size($map) != 0</code> or <code>map:exists($map)</code> (see <a href="https://github.com/qt4cg/qtspecs/issues/827">#827</a> for the naming controversy).<br>Note that <code>if($map)</code> will also return <code>false()</code> is <code>$map</code> is an empty sequence.</li>
<li><code>if($func) { $func(1, 2) }</code> instead of <code>exists($func)</code></li>
</ul>
<p>In the last comments of #817, it was addressed that the behavior of existing code may change if errors are replaced by results. I hope we can live with that, as I cannot think of cases in which the EBV computation make sense for items that always raise an error.</p>
<p>Which option do some of you prefer?</p>
</div></details></div>
<div class="toot" id="closed-817"><h2>Issue #817 closed<span class="toot-id"> #closed-817</span></h2><div class="pubdate">12 Nov at 09:07:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/817">https://github.com/qt4cg/qtspecs/issues/817</a></div><p>EBV 4.0</p></div>
<div class="toot" id="created-828"><h2>Pull request #828 created<span class="toot-id"> #created-828</span></h2><div class="pubdate">11 Nov at 22:51:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/828">https://github.com/qt4cg/qtspecs/pull/828</a></div><details><summary>516 Add position argument to HOF callbacks</summary><div class="markup"><p>I have added positional parameters to the following functions:</p>
<pre><code>array:filter
array:fold-left
array:fold-right
array:for-each
array:for-each-pair
array:index-where
fn:every
fn:filter
fn:fold-left
fn:fold-right
fn:for-each
fn:for-each-pair
fn:index-where
fn:items-after
fn:items-before
fn:items-ending-where
fn:items-starting-where
fn:iterate-while
fn:partition
fn:some
</code></pre>
<p>Comments:</p>
<ul>
<li>For <code>fn:every</code> and <code>fn:some</code>, the additional parameter seemed useful to me, as a positional variable has been requested for quantifier expressions in the past.</li>
<li>I’ve also added positional variables to folds.</li>
<li>I’ve unified and simplified the formal XPath/XQuery equivalencies in the rule sets.</li>
<li>I’ve dropped some XSLT equivalencies because I felt that the XQuery representations are more concise (I certainly won't mind if they're added back).</li>
</ul>
</div></details></div>
<div class="toot" id="created-827"><h2>Issue #827 created<span class="toot-id"> #created-827</span></h2><div class="pubdate">09 Nov at 14:36:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/827">https://github.com/qt4cg/qtspecs/issues/827</a></div><details><summary>map:empty, map:exists ← array:empty, array:exists</summary><div class="markup"><p>We have <code>array:empty</code> and <code>array:exists</code>, but no equivalent functions for maps.</p>
<p>I think we have decided to live with the ambiguity (discussed in #229) that <code>map:exists(map {})</code> will return <code>false</code> although the “map exists”. Same for arrays.</p>
</div></details></div>
<div class="toot" id="created-826"><h2>Issue #826 created<span class="toot-id"> #created-826</span></h2><div class="pubdate">09 Nov at 14:03:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/826">https://github.com/qt4cg/qtspecs/issues/826</a></div><details><summary>Arrays: Representation of single members of an array</summary><div class="markup"><p>When introducing the new array features to some users, the <code>for member</code> syntax was welcomed by everyone.</p>
<p>However, there was some confusion (again, see my past <a href="https://lists.w3.org/Archives/Public/public-xslt-40/2023Jun/0026.html">feedback to the mailing list</a>) about what the QT4 group considers to be “members of an array”, and about value records.</p>
<p>In particular, the “value record” representation of arrays led to questions that I didn’t have a good answer for. In particular, people didn’t understand why an array member was returned as a map, and why that map is (again) called “array member” or “value record” – a term no one associated with arrays (at least for now… which somewhat is not surprising, as it has just been introduced).</p>
<p>Next, due to atomization (as mentioned before), <code>array:split</code> allows us to omit the explicit <code>?value</code> lookups that are required for <code>array:members</code>:</p>
<pre><code class="language-xquery">sum(array:members($array)?value)
sum(array:split($array))
</code></pre>
<p>I suppose I have been biased in my presentation, but I’ve failed to give good arguments to justify the current solution in the spec. The questions that I think need to be answered are:</p>
<ul>
<li>How will people benefit from the (usually intermediate) map representation for array members?</li>
<li>What exactly do we win with <code>array:members</code> and <code>array:of-members</code> instead of using the existing <code>array:join</code> function, combined with the new <code>array:split</code> function?</li>
</ul>
<p>Out of interest, I have rewritten the formal equivalencies for the array functions with <code>array:split</code>/<code>array:join</code>:</p>
<ul>
<li><code>array:append</code></li>
</ul>
<p><code>array:of-members((array:members($array), map{'value':$member}))</code>
<code>array:join((array:split($array), array { $member }))</code></p>
<ul>
<li><code>array:build</code></li>
</ul>
<p><code>array:of-members($input ! map { 'value': $action(.) })</code>
<code>array:join($input ! array { $action(.) })</code></p>
<ul>
<li><code>array:filter</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; filter(function($m) { $predicate($m?value) })</code>
<code>array:join(array:split($array) =&gt; filter(function($m) { $predicate($m?*) })</code></p>
<ul>
<li><code>array:for-each</code></li>
</ul>
<p><code>array:of-members(array:members($array) ! map { 'value': $action(?value) })</code>
<code>array:join(array:split($array) ! array { $action(?*) })</code></p>
<ul>
<li><code>array:for-each-pair</code></li>
</ul>
<pre><code>array:of-members(`
  for-each-pair(array:members($array1), 
    array:members($array2), 
    function($m, $n) {map{'value': $action($m?value, $n?value)}}))
array:join(
  for-each-pair(array:split($array1), array:split($array2),
    function($m, $n) { array { $action($m?*, $n?*) } }))
</code></pre>
<ul>
<li><code>array:insert-before</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; insert-before($position, map{'value':$member}))</code>
<code>array:join(array:split($array) =&gt; insert-before($position, array { $member }))</code></p>
<ul>
<li><code>array:remove</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; remove($positions))</code>
<code>array:join(array:split($array) =&gt; remove($positions))</code></p>
<ul>
<li><code>array:reverse</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; reverse())</code>
<code>array:join(array:split($array) =&gt; reverse())</code></p>
<ul>
<li><code>array:slice</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; slice($start, $end, $step))</code>
<code>array:join(array:split($array) =&gt; slice($start, $end, $step))</code></p>
<ul>
<li><code>array:split</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; sort($collation, function($x) { $key($x?value) }))</code>
<code>array:join(array:split($array) =&gt; sort($collation, function($x) { $key($x?*) }))</code></p>
<ul>
<li><code>array:subarray</code></li>
</ul>
<p><code>array:of-members(array:members($array) =&gt; subsequence($start, $length))</code>
<code>array:join(array:split($array) =&gt; subsequence($start, $length))</code></p>
<ul>
<li><code>array { $sequence }</code></li>
</ul>
<p><code>array:of-members($sequence ! map { 'value': . })</code>
<code>array:join($sequence ! array { . })</code></p>
<ul>
<li><code>[E1, E2, E3, ..., En]</code></li>
</ul>
<p><code>array:join((map { 'value': E1 }, map { 'value': E2 }, map { 'value': E3 }, ... map { 'value': En }))</code>
<code>array:join((array { E1 }, array { E2 }, array { E3 }, ... array { En }))</code></p>
<ul>
<li><code>$array?*</code></li>
</ul>
<p><code>array:members($array) ! ?value</code>
<code>array:split($array) ! ?*</code></p>
<ul>
<li><code>$array?$N / $array($N)</code></li>
</ul>
<p><code>array:members($array)[$N]?value</code>
<code>array:split($array)[$N]?*</code>  (or <code>array:get($array, $N)</code>)</p>
<hr>
<p>As a side note, I noticed that the equivalence given for <code>array:join</code> must be buggy:</p>
<pre><code class="language-xquery">(: current equivalence presented in the spec :)
array:of-members($arrays ! array:members(.))

(: returns [ 1, 2, 3 ] :)
let $arrays := ([ 1 ], [ 2, 3 ])
return array:of-members($arrays ! array:members(.))
</code></pre>
<p>Concluding, If I could choose, I would tend to drop <code>array:members</code> and <code>array:of-members</code> and rename <code>array:split</code> to <code>array:members</code>.</p>
</div></details></div>
<div class="toot" id="created-825"><h2>Issue #825 created<span class="toot-id"> #created-825</span></h2><div class="pubdate">09 Nov at 02:03:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/825">https://github.com/qt4cg/qtspecs/issues/825</a></div><details><summary>FO: Missing function array:members-at</summary><div class="markup"><p>The title says it all.</p>
<p>We have <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-slice"><strong>fn:slice</strong></a> and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-array-slice"><strong>array:slice</strong></a>. We also do have <strong><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-items-at">fn:items-at</a></strong>, but we have somehow missed to add the corresponding <s><strong>array:items-at</strong></s> <strong>array:members-at</strong> function.</p>
<p>We could even think of a function <strong>map:entries-at</strong> and <strong>map:values-for-keys</strong>. The first of these would return all map entries that have as keys one of the provided as argument set of keys. The 2nd function would return all values of the map entries that have as keys one of the provided as argument set of keys.</p>
<p>Here is a complete XPath 3.1 implementation:</p>
<pre><code class="language-xq">let $members-at := function(
                 $input as array( *), 
                 $indexes as xs:integer*
                ) as array(*)
 {
   array {
          for $ind in $indexes
          return $input($ind)
         }
 }
</code></pre>
</div></details></div>
<div class="toot" id="closed-771"><h2>Issue #771 closed<span class="toot-id"> #closed-771</span></h2><div class="pubdate">08 Nov at 20:59:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/771">https://github.com/qt4cg/qtspecs/issues/771</a></div><p>British vs. American English</p></div>
<div class="toot" id="created-824"><h2>Pull request #824 created<span class="toot-id"> #created-824</span></h2><div class="pubdate">08 Nov at 20:42:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/824">https://github.com/qt4cg/qtspecs/pull/824</a></div><details><summary>799 errors in examples; 738 section heading for fn:op</summary><div class="markup"><p>Fix #799
Fix #738</p>
</div></details></div>
<div class="toot" id="created-823"><h2>Pull request #823 created<span class="toot-id"> #created-823</span></h2><div class="pubdate">08 Nov at 20:20:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/823">https://github.com/qt4cg/qtspecs/pull/823</a></div><details><summary>712 Extend array:sort to align with fn:sort</summary><div class="markup"><p>Fix #712</p>
</div></details></div>
<div class="toot" id="closed-480"><h2>Issue #480 closed<span class="toot-id"> #closed-480</span></h2><div class="pubdate">08 Nov at 14:17:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/480">https://github.com/qt4cg/qtspecs/issues/480</a></div><p>Allow type promotion of xs:string to xs:anyURI</p></div>
<div class="toot" id="created-822"><h2>Issue #822 created<span class="toot-id"> #created-822</span></h2><div class="pubdate">08 Nov at 12:41:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/822">https://github.com/qt4cg/qtspecs/issues/822</a></div><details><summary>XQuery, XQFO: Edits (pool)</summary><div class="markup"><p>XQuery spec:</p>
<ul>
<li>[ ] 4.3.4 Context Value Reference → 4.3.4 Context Value Reference<strong>s</strong> (plural, in alignment with the other expressions)</li>
<li>[ ] Move <strong>4.3.4</strong> before <strong>4.3.3 Parenthesized Expressions</strong> (and after <strong>4.3.2 Variable References</strong>)</li>
<li>[ ] 4.19 Switch Expression → 4.19 Switch Expression<strong>s</strong></li>
</ul>
<p>XQFO spec:</p>
<ul>
<li>[ ] Unify representation of equivalent examples, implementations, …see https://github.com/qt4cg/qtspecs/pull/828#issuecomment-1807222990</li>
<li>…</li>
</ul>
</div></details></div>
<div class="toot" id="closed-820"><h2>Issue #820 closed<span class="toot-id"> #closed-820</span></h2><div class="pubdate">08 Nov at 11:40:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/820">https://github.com/qt4cg/qtspecs/issues/820</a></div><p>FLWOR: Variable Bindings, coercion</p></div>
<div class="toot" id="created-821"><h2>Issue #821 created<span class="toot-id"> #created-821</span></h2><div class="pubdate">08 Nov at 11:32:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/821">https://github.com/qt4cg/qtspecs/issues/821</a></div><details><summary>Annotations: Make default namespace explicit</summary><div class="markup"><p>In XQuery, the default namespace for annotations is <code>http://www.w3.org/2012/</code>. It’s the only namespace for which no prefix exists, and I think we should change that. <code>ann</code> feels like a reasonable choice to me as we tend to have short prefixes (such as <code>err</code> for errors).</p>
</div></details></div>
<div class="toot" id="created-820"><h2>Issue #820 created<span class="toot-id"> #created-820</span></h2><div class="pubdate">08 Nov at 11:25:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/820">https://github.com/qt4cg/qtspecs/issues/820</a></div><details><summary>FLWOR: Variable Bindings, coercion</summary><div class="markup"><p>In the current XQuery 4, the coercion rules are applied to variable bindings of FLWOR expressions:</p>
<p>https://qt4cg.org/specifications/xquery-40/xquery-40-diff.html#id-binding-rules</p>
<p>I believe this is yet another feature that needs to be formally accepted. If it has already been done so, this issue can be closed again immediately (maybe with a reference to the related issue, or the associated QT4 meeting).</p>
</div></details></div>
<div class="toot" id="closed-65"><h2>Issue #65 closed<span class="toot-id"> #closed-65</span></h2><div class="pubdate">08 Nov at 10:00:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/65">https://github.com/qt4cg/qtspecs/issues/65</a></div><p>Support using different input/output element namespaces</p></div>
<div class="toot" id="closed-238"><h2>Issue #238 closed<span class="toot-id"> #closed-238</span></h2><div class="pubdate">08 Nov at 09:59:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/238">https://github.com/qt4cg/qtspecs/issues/238</a></div><p>Support Invisible XML</p></div>
<div class="toot" id="closed-789"><h2>Issue #789 closed<span class="toot-id"> #closed-789</span></h2><div class="pubdate">08 Nov at 09:55:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/789">https://github.com/qt4cg/qtspecs/issues/789</a></div><p>Serialization spec: terminology</p></div>
<div class="toot" id="closed-807"><h2>Issue #807 closed<span class="toot-id"> #closed-807</span></h2><div class="pubdate">08 Nov at 09:55:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/807">https://github.com/qt4cg/qtspecs/pull/807</a></div><p>789 Serialization terminology [editorial]</p></div>
<div class="toot" id="closed-791"><h2>Issue #791 closed<span class="toot-id"> #closed-791</span></h2><div class="pubdate">07 Nov at 18:14:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/791">https://github.com/qt4cg/qtspecs/pull/791</a></div><p>238: First draft of an fn:invisible-xml function</p></div>
<div class="toot" id="closed-130"><h2>Issue #130 closed<span class="toot-id"> #closed-130</span></h2><div class="pubdate">07 Nov at 18:12:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/130">https://github.com/qt4cg/qtspecs/issues/130</a></div><p>New super/union type xs:binary?</p></div>
<div class="toot" id="closed-815"><h2>Issue #815 closed<span class="toot-id"> #closed-815</span></h2><div class="pubdate">07 Nov at 18:12:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/815">https://github.com/qt4cg/qtspecs/pull/815</a></div><p>130,480 Binary Promotion</p></div>
<div class="toot" id="closed-772"><h2>Issue #772 closed<span class="toot-id"> #closed-772</span></h2><div class="pubdate">07 Nov at 18:08:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/772">https://github.com/qt4cg/qtspecs/pull/772</a></div><p>Revise the fn:parse-html rules to make them clearer to follow.</p></div>
<div class="toot" id="closed-809"><h2>Issue #809 closed<span class="toot-id"> #closed-809</span></h2><div class="pubdate">07 Nov at 18:06:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/809">https://github.com/qt4cg/qtspecs/issues/809</a></div><p>Placement of fn:atomic-equal in the specification</p></div>
<div class="toot" id="closed-813"><h2>Issue #813 closed<span class="toot-id"> #closed-813</span></h2><div class="pubdate">07 Nov at 18:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/813">https://github.com/qt4cg/qtspecs/pull/813</a></div><p>809 Move fn:atomic-equal to section 14.2</p></div>
<div class="toot" id="closed-806"><h2>Issue #806 closed<span class="toot-id"> #closed-806</span></h2><div class="pubdate">07 Nov at 18:02:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/806">https://github.com/qt4cg/qtspecs/pull/806</a></div><p>566 A few minor fixes for parse-uri</p></div>
<div class="toot" id="closed-804"><h2>Issue #804 closed<span class="toot-id"> #closed-804</span></h2><div class="pubdate">07 Nov at 17:58:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/804">https://github.com/qt4cg/qtspecs/pull/804</a></div><p>Minor edits, XQFO chh. 7, 8</p></div>
<div class="toot" id="closed-651"><h2>Issue #651 closed<span class="toot-id"> #closed-651</span></h2><div class="pubdate">07 Nov at 17:45:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/651">https://github.com/qt4cg/qtspecs/issues/651</a></div><p>fn:log → fn:message</p></div>
<div class="toot" id="closed-803"><h2>Issue #803 closed<span class="toot-id"> #closed-803</span></h2><div class="pubdate">07 Nov at 17:45:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/803">https://github.com/qt4cg/qtspecs/pull/803</a></div><p>651: fn:log → fn:message</p></div>
<div class="toot" id="closed-801"><h2>Issue #801 closed<span class="toot-id"> #closed-801</span></h2><div class="pubdate">07 Nov at 17:45:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/801">https://github.com/qt4cg/qtspecs/issues/801</a></div><p>nondeterministic vs non-deterministic</p></div></div><p>See 1539
            more statuses in yearly archives.</p></article></main></body></html>