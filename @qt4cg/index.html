<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="minutes-10-17"><h2>QT4 CG meeting 050 draft minutes<span class="toot-id"> #minutes-10-17</span></h2><div class="pubdate">17 Oct at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2023/10-17">https://qt4cg.org/meeting/minutes/2023/10-17</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-757"><h2>Issue #757 created<span class="toot-id"> #created-757</span></h2><div class="pubdate">17 Oct at 16:24:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/757">https://github.com/qt4cg/qtspecs/issues/757</a></div><details><summary>Function families</summary><div class="markup"><p>We talked on the call today about the tension between defining multiple simple functions focussed on one task, and a small number of omnibus functions that have many different options.</p>
<p>I think we would all agree that multiple simple functions would be the better choice except for the problem that they all end up going into a single global namespace. So the question becomes, how can we better partition the name-space (using the term deliberately with a hyphen).</p>
<p>We're reluctant to use the namespace mechanism to partition our function library because namespaces are cumbersome and clutter the code with lots of boilerplate; declaring namespaces for binding function libraries also has side-effects for example on the semantics of element constructors.</p>
<p>One approach would be to build on the idea that @dnovatchev presented of using maps containing anonymous functions, so for example <code>csv()?parse()</code> would first call fn:csv() to load a family (or library) of functions, of which one is then selected for execution. This works, but I don't think it's a perfect solution; for example static analysis becomes a lot more difficult, and we don't get the benefits of default parameters and keyword arguments.</p>
<p>Most languages use hierarchic names with "." as a separator. Although XML names allow "." as a regular character, none of our built-in function names currently use it as such. So it would be entirely possible to adopt a convention where names like csv.parse() etc are used to name functions in a function family referred to as "csv". This wouldn't by itself require any language changes.</p>
<p>But if we adopted this convention, we could build on it to provide usability tweaks that make a large function library easier to manage. For example, we could put the math functions into the fn namespace with names like <code>fn:math.sin(x)</code>, and then provide a way of binding a namespace prefix to a subtree of the fn namespace, so math:sin becomes a synonym for fn:math.sin(). The immediate benefit is that the namespace prefix doesn't need to be declared unless people want to use it. We could also then consider defining an algorithm for searching the fn namespace for abbreviated names such as sin(x), perhaps with some form of "import functions" declaration that says which subtrees of the fn namespace are to be searched.</p>
</div></details></div>
<div class="toot" id="closed-741"><h2>Issue #741 closed<span class="toot-id"> #closed-741</span></h2><div class="pubdate">17 Oct at 16:20:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/741">https://github.com/qt4cg/qtspecs/pull/741</a></div><p>QT4CG-048-03: Fix copy and paste errors in describing type patterns</p></div>
<div class="toot" id="closed-739"><h2>Issue #739 closed<span class="toot-id"> #closed-739</span></h2><div class="pubdate">17 Oct at 16:18:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/739">https://github.com/qt4cg/qtspecs/pull/739</a></div><p>Apply review comment changes to the HTML DOM XDM mapping.</p></div>
<div class="toot" id="closed-618"><h2>Issue #618 closed<span class="toot-id"> #closed-618</span></h2><div class="pubdate">17 Oct at 15:49:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/618">https://github.com/qt4cg/qtspecs/issues/618</a></div><p>Symmetry: fn:html-doc, fn:csv-doc</p></div>
<div class="toot" id="created-756"><h2>Issue #756 created<span class="toot-id"> #created-756</span></h2><div class="pubdate">17 Oct at 14:39:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/756">https://github.com/qt4cg/qtspecs/issues/756</a></div><details><summary>JSON serialization - number formatting</summary><div class="markup"><p>We get a lot of complaints about the use of exponential notation when formatting large numbers with the JSON serializer.</p>
<p>I propose adding an option such as number-format="picture" to control this, where the picture is a subset of what is allowed for format-number().</p>
<p>And perhaps we should bring <code>xml-to-json()</code> into line. The current capability of providing a callback function is more powerful, but difficult to align with serialization.</p>
</div></details></div>
<div class="toot" id="closed-131"><h2>Issue #131 closed<span class="toot-id"> #closed-131</span></h2><div class="pubdate">17 Oct at 11:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/131">https://github.com/qt4cg/qtspecs/issues/131</a></div><p>Expression for binding the Context Value</p></div>
<div class="toot" id="created-755"><h2>Issue #755 created<span class="toot-id"> #created-755</span></h2><div class="pubdate">17 Oct at 11:15:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/755">https://github.com/qt4cg/qtspecs/issues/755</a></div><details><summary>Expression for binding the Context Value</summary><div class="markup"><p>We have no expression yet to bind a value to the context value. Such an expression would be useful, among other things, to extend the focus function to sequences (<code>fn { . }</code>, see #129).</p>
<p>Here are 3 possible constructs for that, ordered by my personal preference:</p>
<h3>1. Value Map Expression</h3>
<pre><code class="language-xquery">ValueExpr      ::=  ValidateExpr | ExtensionExpr | ValueMapExpr
ValueMapExpr   ::=  SimpleMapExpr ("~" SimpleMapExpr)*
SimpleMapExpr  ::=  PathExpr ("!" PathExpr)*

(: Example :)
//flower ~ (count(.) || ' flowers: ' || string-join(name, ', '))
</code></pre>
<p>The expression would be similar to the simple map expression (which we could rename to item map expression). The following equivalents would then exist for simple FLWOR expressions:</p>
<pre><code class="language-xquery">for $i in (1 to 5) return string($i)  ≍  (1 to 5) ! string(.)
let $i := (1 to 5) return count($i)   ≍  (1 to 5) ~ count(.)
</code></pre>
<p><code>fn { E }</code> could be rewritten to <code>fn($c) { $c ~ E }</code>.</p>
<h3>2. Context Value Declaration</h3>
<pre><code class="language-xquery">ContextExpr  ::=  "context" "{" Expr "}" EnclosedExpr

(: Example :)
context { //flower } {
  count(.) || ' flowers: ' || string-join(name, ', ')
}
</code></pre>
<p>The result of the first expression defines the context value, the second expression can reference the context.</p>
<p><code>fn { E }</code> could be rewritten to <code>fn($c) { context { $c } { E } }</code>.</p>
<h3>3. Enhanced FLWOR expression (for the sake of completion)</h3>
<p>Similar to variables, the dot could be used to bind and reference the context:</p>
<pre><code class="language-xquery">LetBinding  ::=  ("." | ("$" VarName)) TypeDeclaration? ":=" ExprSingle
ForBinding  ::=  ("." | ("$" VarName)) TypeDeclaration? AllowingEmpty? PositionalVar? "in" ExprSingle

(: Example :)
let . := //flower
return count(.) || ' flowers: ' || string-join(name, ', ')
</code></pre>
<p><code>fn { E }</code> could be rewritten to <code>fn($c) { let . := $c return E }</code>.</p>
<h3>Assessment</h3>
<ul>
<li>The first solution looks most appealing to me. I like the analogy with the existing syntax for single items.</li>
<li>We could choose the second solution if we believe that the expression will be rarely used.</li>
<li>I‘ve backed away from the third solution; I think it would be too pervasive.</li>
</ul>
</div></details></div>
<div class="toot" id="created-754"><h2>Issue #754 created<span class="toot-id"> #created-754</span></h2><div class="pubdate">17 Oct at 07:22:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/754">https://github.com/qt4cg/qtspecs/issues/754</a></div><details><summary>fn:transitive-closure: signature; remarks; too specific?</summary><div class="markup"><p>I have problems grasping why <code>fn:transitive-closure</code> returns a function. Wouldn’t it be more consistent with the remaining function set, and easier, to pass on the input as the first argument and directly create the result?</p>
<pre><code class="language-xquery">fn:transitive-closure(
  $node  as node(),
  $step  as function(node()) as node()*,	
  $min   as xs:nonNegativeInteger?       := 1,
  $max   as xs:positiveInteger?          := ()
) as node()*
</code></pre>
<p>It would also be easier then to use the function within chains:</p>
<pre><code class="language-xquery">$nodes =!&gt; transitive-closure(fn { * }) =&gt; count()
</code></pre>
</div></details></div>
<div class="toot" id="closed-744"><h2>Issue #744 closed<span class="toot-id"> #closed-744</span></h2><div class="pubdate">16 Oct at 14:32:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/744">https://github.com/qt4cg/qtspecs/pull/744</a></div><p>XQFO Examples: minor fixes, formatting</p></div>
<div class="toot" id="created-753"><h2>Pull request #753 created<span class="toot-id"> #created-753</span></h2><div class="pubdate">16 Oct at 14:05:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/753">https://github.com/qt4cg/qtspecs/pull/753</a></div><details><summary>65: Allow xmlns="xxx" to NOT change the default namespace for NameTests</summary><div class="markup"><p>Fix issue #65. Basically, fix the bug whereby <code>xmlns="xxx"</code> changes the default namespace for element NameTests, while retaining bug-compatibility.</p>
</div></details></div>
<div class="toot" id="agenda-10-17"><h2>QT4 CG meeting 050 draft agenda<span class="toot-id"> #agenda-10-17</span></h2><div class="pubdate">16 Oct at 12:55:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2023/10-17">https://qt4cg.org/meeting/agenda/2023/10-17</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-649"><h2>Issue #649 closed<span class="toot-id"> #closed-649</span></h2><div class="pubdate">16 Oct at 12:33:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/649">https://github.com/qt4cg/qtspecs/issues/649</a></div><p>xsl:fallback</p></div>
<div class="toot" id="closed-650"><h2>Issue #650 closed<span class="toot-id"> #closed-650</span></h2><div class="pubdate">16 Oct at 12:33:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/650">https://github.com/qt4cg/qtspecs/pull/650</a></div><p>649: fix an xsl:fallback problem</p></div>
<div class="toot" id="created-752"><h2>Pull request #752 created<span class="toot-id"> #created-752</span></h2><div class="pubdate">16 Oct at 09:21:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/752">https://github.com/qt4cg/qtspecs/pull/752</a></div><details><summary>706: Fix "for member" grammar problems</summary><div class="markup"><p>Fix #706</p>
</div></details></div>
<div class="toot" id="created-751"><h2>Pull request #751 created<span class="toot-id"> #created-751</span></h2><div class="pubdate">16 Oct at 06:41:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/751">https://github.com/qt4cg/qtspecs/pull/751</a></div><details><summary>QT4CG-048-01: xsl:mode/@as with built-in templates</summary><div class="markup"><p>Fix #750.</p>
</div></details></div>
<div class="toot" id="created-750"><h2>Issue #750 created<span class="toot-id"> #created-750</span></h2><div class="pubdate">15 Oct at 22:56:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/750">https://github.com/qt4cg/qtspecs/issues/750</a></div><details><summary>xsl:mode/@as and built-in template rules</summary><div class="markup"><p>See ACTION QT4CG-048-01</p>
<p>The question arose, if an xsl:mode declaration specifies an expected type in @as, then all template rules in that mode are expected/required to deliver a value conforming to that type. But what about the default/fallback template rules? Surely they need to deliver a value of that type as well?</p>
<p>For example, suppose the mode specifies as="xs:boolean". Regardless of the value of <code>xsl:on-no-match</code>, none of the built-in template rules is going to deliver a boolean. You're expecting a boolean result from xsl:apply-templates, and if none of the template rules match, you're going to get something other than a boolean.</p>
<p>I think the answer is to say that you get a type error if the built-in template rule for the mode returns a value that's not of the required type.</p>
<p>I don't think this error should ever be reported statically, because the compiler has no way of knowing whether the set of explicit template rules is sufficient to cover all cases that will actually arise in source documents.</p>
</div></details></div>
<div class="toot" id="closed-571"><h2>Issue #571 closed<span class="toot-id"> #closed-571</span></h2><div class="pubdate">15 Oct at 22:29:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/571">https://github.com/qt4cg/qtspecs/issues/571</a></div><p>XSLT: xsl:for-each-group/@break-when</p></div>
<div class="toot" id="created-749"><h2>Pull request #749 created<span class="toot-id"> #created-749</span></h2><div class="pubdate">15 Oct at 20:24:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/749">https://github.com/qt4cg/qtspecs/pull/749</a></div><details><summary>653: Add string literals E".." and L".." to control entity expansion</summary><div class="markup"><p>Allows for expressions interoperable between XPath and XQuery. Fix #653.</p>
</div></details></div>
<div class="toot" id="created-748"><h2>Issue #748 created<span class="toot-id"> #created-748</span></h2><div class="pubdate">15 Oct at 17:40:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/748">https://github.com/qt4cg/qtspecs/issues/748</a></div><details><summary>Parse functions: consistency</summary><div class="markup"><p>The functions for parsing input have been defined by different people, and the current state is quite inconsistent:</p>
<p>Function | Parameters
--- | ---
<code>fn:parse-xml</code> | <code>$value as xs:string?</code>
<code>fn:doc</code> | <code>$href as xs:string?</code>
<code>fn:parse-json</code> | <code>$value as xs:string?, $options as map(*)</code>
<code>fn:json-doc</code> | <code>$href as xs:string?, $options as map(*)</code>
<code>fn:parse-html</code> | <code>$html as union(xs:string, xs:hexBinary, xs:base64Binary)?, $options as map(*)</code>
<code>fn:parse-csv</code> | <code>$csv as xs:string?, $options as map(*)</code></p>
<p>I believe there’s some need to unify the functions, and we could at least:</p>
<ul>
<li>introduce a <code>fn:XYZ-doc($href, $options)</code> function for each input format (with at least one <code>encoding</code> option), and</li>
<li>restrict the type of the input parameter of <code>fn:parse-XYZ</code> to <code>xs:string?</code> and alwys name it <code>$value</code>.</li>
</ul>
<p>And I wonder if we should tag all <code>fn:XYZ-doc</code> functions as ·nondeterministic· (if it’s not too late)?</p>
</div></details></div>
<div class="toot" id="created-747"><h2>Issue #747 created<span class="toot-id"> #created-747</span></h2><div class="pubdate">15 Oct at 09:27:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/747">https://github.com/qt4cg/qtspecs/issues/747</a></div><details><summary>QName literals</summary><div class="markup"><p>It's quite common to want to write a constant QName; I found myself doing this a lot, for example, in examples and test cases for the <code>elements-to-maps()</code> function. It's clumsy having to call <code>xs:QName()</code> or <code>fn:QName()</code> or <code>parse-QName()</code> for this purpose. It's particularly clumsy with map constructors where you want to write many QNames.</p>
<p>I propose we introduce the syntax <code>Q"prefix:local"</code>.</p>
<p>The quotes can be either single or double; the prefix is optional. If there is no prefix, the result is a no-namespace QName.</p>
<p>The prefix (if present) must be bound to a namespace in the static context.</p>
<p>Character and entity references are not allowed.</p>
<p>Note that <code>Q{uri}local</code> is a NameTest, not a QName literal.</p>
</div></details></div>
<div class="toot" id="created-746"><h2>Issue #746 created<span class="toot-id"> #created-746</span></h2><div class="pubdate">14 Oct at 18:16:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/746">https://github.com/qt4cg/qtspecs/issues/746</a></div><details><summary>break-when -&gt; split-when in fn:partition</summary><div class="markup"><p>We decided to rename <code>xsl:for-each-group/@break-when</code> as <code>@split-when</code>. We should make the same change to the name of the second argument of <code>fn:partition</code>.</p>
</div></details></div>
<div class="toot" id="created-745"><h2>Issue #745 created<span class="toot-id"> #created-745</span></h2><div class="pubdate">12 Oct at 11:21:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/745">https://github.com/qt4cg/qtspecs/issues/745</a></div><details><summary>Support for inline (anonymous) xslt functions</summary><div class="markup"><p>I propose adding support for inline xslt functions.</p>
<p>Whilst XPath supports this, Xpath functions are limited in what they can do, and how "look" e.g. returning newly constructed elements isnt possible without parse-xml-fragment.</p>
<p>I would suggest the syntax would be basically the same as for xsl:function except with the name omitted, e.g.</p>
<pre><code>    &lt;xsl:template name="apply-function" as="xs:integer"&gt;
        &lt;xsl:param name="input" as="xs:integer"/&gt;
        &lt;xsl:param name="function" as="function(xs:integer) as xs:integer"/&gt;
        &lt;xsl:sequence select="$function($input)"/&gt;
    &lt;/xsl:template&gt;

`    &lt;xsl:template ....&gt;
        &lt;xsl:call-template name="apply-function"&gt;
            &lt;xsl:with-param name="input" select="1"/&gt;
            &lt;xsl:with-param name="function"&gt;
                &lt;xsl:function as="xs:integer"&gt;
                    &lt;xsl:param name="value" as="xs:integer"/&gt;
                    &lt;result&gt;
                        &lt;xsl:sequence select="$value * 2"/&gt;
                    &lt;/result&gt;
                &lt;/xsl:function&gt;
            &lt;/xsl:with-param&gt;
        &lt;/xsl:call-template&gt;
    &lt;/xsl:template&gt;
`
</code></pre>
<p>benefits</p>
<ul>
<li>less syntactic "noise" of named functions</li>
<li>the ability to embed xslt functions inline inside maps (and other data types)</li>
<li>functional parity with xpath (and more)</li>
<li>natural generalisation to local function proposal</li>
</ul>
<p>alternatives</p>
<ul>
<li>use reference to explicitly named XSLT function</li>
<li>use XPath (though problematic when constructing new nodes)</li>
</ul>
</div></details></div>
<div class="toot" id="created-744"><h2>Pull request #744 created<span class="toot-id"> #created-744</span></h2><div class="pubdate">11 Oct at 11:48:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/744">https://github.com/qt4cg/qtspecs/pull/744</a></div><details><summary>XQFO Examples: minor fixes, formatting</summary><div class="markup"><p>Editorial: Some XQuery equivalents were buggy, and the formatting was unified.</p>
</div></details></div>
<div class="toot" id="created-743"><h2>Issue #743 created<span class="toot-id"> #created-743</span></h2><div class="pubdate">10 Oct at 23:33:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/743">https://github.com/qt4cg/qtspecs/issues/743</a></div><details><summary>Extend enumeration types to allow values other than strings</summary><div class="markup"><p>In reviewing and accepting the spec for enumeration types, it was suggested that it might be useful to allow values other than strings.</p>
<ul>
<li>There's a difficulty in that not all atomic values can be represented by literals. We have the same problem with function annotations; perhaps we need to bite the bullet and define some kind of "constant atomic expression" construct.</li>
<li>Aside from that, there don't seem to be any major obstacles.</li>
</ul>
<p>We change</p>
<blockquote>
<p>An EnumerationType has a value space consisting of a set of xs:string values. When matching strings against an enumeration type, strings are always compared using the Unicode codepoint collation.</p>
</blockquote>
<p>to</p>
<blockquote>
<p>An EnumerationType has a value space consisting of a set of atomic values. When matching values against an enumeration type, values are always compared using the fn:atomic-compare() function (as used for comparing map keys).</p>
</blockquote>
<p>The subtyping rules (newly defined in terms of unions of singleton enumeration sets) seem to work in their current form, without change. <code>enum("red", "green")</code> is still a subtype of <code>xs:string</code>, because all the enumerated values are instances of <code>xs:string</code>.</p>
</div></details></div>
<div class="toot" id="minutes-10-10"><h2>QT4 CG meeting 049 draft minutes<span class="toot-id"> #minutes-10-10</span></h2><div class="pubdate">10 Oct at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2023/10-10">https://qt4cg.org/meeting/minutes/2023/10-10</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-742"><h2>Issue #742 created<span class="toot-id"> #created-742</span></h2><div class="pubdate">10 Oct at 16:30:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/742">https://github.com/qt4cg/qtspecs/issues/742</a></div><details><summary>xsl:function-library: keep, drop, or refine?</summary><div class="markup"><p>The draft XSLT 4.0 specification (§5.3.2) proposes a new declaration xsl:function-library as a solution to the problem of having to qualify all function names except those in the core namespace. We have not reviewed this proposal.</p>
</div></details></div>
<div class="toot" id="closed-688"><h2>Issue #688 closed<span class="toot-id"> #closed-688</span></h2><div class="pubdate">10 Oct at 16:08:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/688">https://github.com/qt4cg/qtspecs/issues/688</a></div><p>Coercion rules for union types and enumeration types</p></div>
<div class="toot" id="closed-691"><h2>Issue #691 closed<span class="toot-id"> #closed-691</span></h2><div class="pubdate">10 Oct at 16:08:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/691">https://github.com/qt4cg/qtspecs/pull/691</a></div><p>688 Semantics of local union types, enumeration types, etc</p></div>
<div class="toot" id="closed-372"><h2>Issue #372 closed<span class="toot-id"> #closed-372</span></h2><div class="pubdate">10 Oct at 16:07:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/372">https://github.com/qt4cg/qtspecs/issues/372</a></div><p>Separate default namespace for elements from the default namespace for types</p></div></div><p>See 1386
            more statuses in yearly archives.</p></article></main></body></html>