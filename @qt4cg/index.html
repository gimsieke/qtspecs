<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="created-934"><h2>Issue #934 created<span class="toot-id"> #created-934</span></h2><div class="pubdate">08 Jan at 18:00:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/934">https://github.com/qt4cg/qtspecs/issues/934</a></div><details><summary>String comparison in deep-equal</summary><div class="markup"><p>The code showing how strings should be compared in deep-equal has gone awry, it doesn't match the prose. In equal-strings(), the lines</p>
<pre><code>let $n1 := if ($options?whitespace = "normalize"))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  let $n2 := if ($options?normalize-space)
             then normalize-space#1 
             else identity#1      
</code></pre>
<p>should read:</p>
<pre><code>let $n1 := if ($options?whitespace = 'normalize')
             then normalize-space#1 
             else identity#1    
let $n2 := if ($options?normalization-form))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  
</code></pre>
<p>Actually, the whole thing can now be expressed more concisely using fn:chain:</p>
<pre><code>declare function equal-strings(
  $string1   as xs:string,
  $string2   as xs:string, 
  $collation as xs:string,
  $options   as map(*)
) as xs:boolean {
  let $norm := fn:chain(?,
                        (normalize-unicode(?, $options?normalization-form)[$options?whitespace = "normalize"],
                         normalize-space#1[$options?normalize-space]))          
  return compare($norm($string1), $norm($string2), $collation) eq 0    
}
</code></pre>
</div></details></div>
<div class="toot" id="created-933"><h2>Pull request #933 created<span class="toot-id"> #created-933</span></h2><div class="pubdate">08 Jan at 12:49:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/933">https://github.com/qt4cg/qtspecs/pull/933</a></div><details><summary>930 drop obsolete note about comments and PIs</summary><div class="markup"><p>Fix #930</p>
<p>The note is obsolete because adjacent text nodes are now combined after stripping comments and PIs.</p>
</div></details></div>
<div class="toot" id="created-932"><h2>Pull request #932 created<span class="toot-id"> #created-932</span></h2><div class="pubdate">08 Jan at 12:42:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/932">https://github.com/qt4cg/qtspecs/pull/932</a></div><details><summary>931 Add rules for duration precision</summary><div class="markup"><p>Fix #931</p>
<p>Adds rules for the precision of durations and operations on durations, analogous to the existing rules for dates/times.</p>
</div></details></div>
<div class="toot" id="created-931"><h2>Issue #931 created<span class="toot-id"> #created-931</span></h2><div class="pubdate">07 Jan at 10:21:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/931">https://github.com/qt4cg/qtspecs/issues/931</a></div><details><summary>Precision of duration arithmetic</summary><div class="markup"><p>We specify that dates/times are manipulated at least to millisecond precision, but we have no similar statement for durations.</p>
<p>See https://stackoverflow.com/questions/77752844</p>
<p>michael.hor257k points out:</p>
<blockquote>
<p>The 2.0 specification states: "The result is obtained by casting $arg to an xs:dayTimeDuration ... and then computing the seconds component as described in 10.3.2.3 Canonical representation." And then: "The canonical representation of xs:dayTimeDuration restricts ... the value of the seconds component to xs:decimal valued from 0.0 to 59.999... ", with reference to XML Schema Part 2: Datatypes which mandates "a minimum fractional second precision of milliseconds or three decimal digits". None of this appears in the 3.0 spec, though the examples still show a decimal digit being extracted. â€“</p>
</blockquote>
</div></details></div>
<div class="toot" id="closed-929"><h2>Issue #929 closed<span class="toot-id"> #closed-929</span></h2><div class="pubdate">07 Jan at 10:19:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/929">https://github.com/qt4cg/qtspecs/issues/929</a></div><p>map:values() - Would it be better to return an array?</p></div>
<div class="toot" id="created-930"><h2>Issue #930 created<span class="toot-id"> #created-930</span></h2><div class="pubdate">06 Jan at 17:13:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/930">https://github.com/qt4cg/qtspecs/issues/930</a></div><details><summary>Obsolete comment under fn:deep-equal()</summary><div class="markup"><p>The notes for fn:deep-equal() include the paragraph:</p>
<blockquote>
<p>By default, the contents of comments and processing instructions are significant only if these nodes appear directly as items in the two sequences being compared. The content of a comment or processing instruction that appears as a descendant of an item in one of the sequences being compared does not affect the result. However, the presence of a comment or processing instruction, if it causes a text node to be split into two text nodes, may affect the result.</p>
</blockquote>
<p>This is no longer true: we fixed it so that adjacent text nodes are merged after stripping comments and PIs.</p>
</div></details></div>
<div class="toot" id="created-929"><h2>Issue #929 created<span class="toot-id"> #created-929</span></h2><div class="pubdate">06 Jan at 08:34:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/929">https://github.com/qt4cg/qtspecs/issues/929</a></div><details><summary>map:values() - Would it be better to return an array?</summary><div class="markup"><p>The new function <code>map:values()</code> returns the values present in a map, flattened into a sequence.</p>
<p>This loses information if the values are not all singletons.</p>
<p>Would it be better to return an array?</p>
<p>That is, to return <code>array:build(map:pairs($map), fn{?value}))</code></p>
</div></details></div>
<div class="toot" id="created-928"><h2>Pull request #928 created<span class="toot-id"> #created-928</span></h2><div class="pubdate">06 Jan at 02:47:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/928">https://github.com/qt4cg/qtspecs/pull/928</a></div><details><summary>Minor edits through ch. 15</summary><div class="markup"><p>Light edits here for consistency, clarity. I didn't touch the CSV prose much, knowing it is subject to major revisions.</p>
</div></details></div>
<div class="toot" id="created-927"><h2>Pull request #927 created<span class="toot-id"> #created-927</span></h2><div class="pubdate">04 Jan at 18:14:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/927">https://github.com/qt4cg/qtspecs/pull/927</a></div><details><summary>861 Rewrite spec of deep lookup operator</summary><div class="markup"><p>Fix #861</p>
<p>This is a complete rewrite of the spec for deep-lookup, hopefully clarifying some edge cases and fixing bugs, but not intended to introduce any major changes.</p>
</div></details></div>
<div class="toot" id="created-926"><h2>Pull request #926 created<span class="toot-id"> #created-926</span></h2><div class="pubdate">04 Jan at 12:55:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/926">https://github.com/qt4cg/qtspecs/pull/926</a></div><details><summary>860 Editorial rearrangement of spec for shallow lookup</summary><div class="markup"><p>Rearranges the spec for lookup expressions so that unary lookup is now defined in terms of postfix lookup, not the other way around; this simplifies the rules when the context value is not a singleton, or when the key specifier expression is context-dependent.</p>
<p>Fix #860</p>
</div></details></div>
<div class="toot" id="created-925"><h2>Pull request #925 created<span class="toot-id"> #created-925</span></h2><div class="pubdate">03 Jan at 23:39:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/925">https://github.com/qt4cg/qtspecs/pull/925</a></div><details><summary>780 Document incompatibility in format-number etc</summary><div class="markup"><p>Fix #780</p>
<p>Changes the XSLT and F+O specs to document a minor incompatibility arising from the change to functions such as <code>format-number()</code> to accept an argument of type <code>union(xs:string, xs:QName)</code> rather than <code>xs:string</code>.</p>
<p>In addition, in XSLT, all such functions now accept <code>union(xs:string, xs:QName)</code> rather than <code>union(xs:QName, xs:string)</code>. This is primarily to make them all consistent.</p>
</div></details></div>
<div class="toot" id="created-924"><h2>Pull request #924 created<span class="toot-id"> #created-924</span></h2><div class="pubdate">03 Jan at 19:59:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/924">https://github.com/qt4cg/qtspecs/pull/924</a></div><details><summary>648 Disallow user modifications to schema for FN namespace</summary><div class="markup"><p>Fix #648</p>
</div></details></div>
<div class="toot" id="closed-889"><h2>Issue #889 closed<span class="toot-id"> #closed-889</span></h2><div class="pubdate">03 Jan at 19:34:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/889">https://github.com/qt4cg/qtspecs/issues/889</a></div><p>Rename "Named Function Reference"</p></div>
<div class="toot" id="created-923"><h2>Pull request #923 created<span class="toot-id"> #created-923</span></h2><div class="pubdate">02 Jan at 23:02:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/923">https://github.com/qt4cg/qtspecs/pull/923</a></div><details><summary>913-new-examples-for-local-name-etc</summary><div class="markup"><p>I have created new (executable) examples for functions name, local-name, namespace-uri, node-name, count, number.</p>
<p>There are of course many other functions that would benefit from the same treatment.</p>
<p>Fix #913</p>
</div></details></div>
<div class="toot" id="created-922"><h2>Pull request #922 created<span class="toot-id"> #created-922</span></h2><div class="pubdate">01 Jan at 21:23:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/922">https://github.com/qt4cg/qtspecs/pull/922</a></div><details><summary>915 function body terminology</summary><div class="markup"><p>Fix #915</p>
</div></details></div>
<div class="toot" id="created-921"><h2>Pull request #921 created<span class="toot-id"> #created-921</span></h2><div class="pubdate">01 Jan at 20:14:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/921">https://github.com/qt4cg/qtspecs/pull/921</a></div><details><summary>920 Allow xsl:break and xsl:next-iteration within branch of xsl:switch</summary><div class="markup"><p>Allow xsl:break and xsl:next-iteration within branch of xsl:switch</p>
<p>Fix #920</p>
</div></details></div>
<div class="toot" id="created-920"><h2>Issue #920 created<span class="toot-id"> #created-920</span></h2><div class="pubdate">30 Dec at 12:55:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/920">https://github.com/qt4cg/qtspecs/issues/920</a></div><details><summary>The rules for the "tail position" of a sequence constructor need to take account of xsl:switch</summary><div class="markup"><p>Under <code>xsl:iterate</code>, there are rules defining what it means for an instruction to be in a tail position in a sequence constructor. In these rules <code>xsl:switch</code> should be treated the same way as <code>xsl:choose</code>.</p>
</div></details></div>
<div class="toot" id="created-919"><h2>Issue #919 created<span class="toot-id"> #created-919</span></h2><div class="pubdate">28 Dec at 16:14:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/919">https://github.com/qt4cg/qtspecs/issues/919</a></div><details><summary>Should predicate callbacks use EBV?</summary><div class="markup"><p>Currently predicate callback functions used by things like fn:filter have to return a boolean; they can't rely on EBV semantics. For example you have to write <code>fn{boolean(self::p)}</code> rather than <code>fn{self::p}</code>.</p>
<p>It's probably with <code>self</code> tests that this is most noticeable, because self is so often used in a boolean context.</p>
<p>Of course the current rule gives stricter type-checking which will presumably catch some user errors. But it seems an unnecessary inconsistency.</p>
</div></details></div>
<div class="toot" id="created-918"><h2>Pull request #918 created<span class="toot-id"> #created-918</span></h2><div class="pubdate">27 Dec at 03:27:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/918">https://github.com/qt4cg/qtspecs/pull/918</a></div><details><summary>Minor cx through chap. 14</summary><div class="markup"><ul>
<li><code>fn:splice</code> examples expanded to illustrate integer steps other than 1.</li>
<li><code>fn:unparsed-text-lines</code> updated to reflect recent decisions about line handling in <code>fn:unparsed-text</code>.</li>
<li>Other clarifications or corrections.</li>
</ul>
<p>Let me know if any of these edits are misfires.</p>
</div></details></div>
<div class="toot" id="created-917"><h2>Issue #917 created<span class="toot-id"> #created-917</span></h2><div class="pubdate">22 Dec at 19:41:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/917">https://github.com/qt4cg/qtspecs/issues/917</a></div><details><summary>Better support for typed maps</summary><div class="markup"><p><strong>Edit (2023-01-04)</strong>: See https://github.com/qt4cg/qtspecs/issues/917#issuecomment-1875712638 for the most promising suggestion resulting from the discussion in this thread.</p>
<hr>
<p>Inspired by #720 and concerns regarding usability and performance, it may be a big step, but couldnâ€™t we define records as subtypes of maps?</p>
<ul>
<li>The main difference would be that updates on records are only allowed as long as the resulting map matches a record definition.</li>
<li>This would allow us to return much better error messages, and to prevent users from deconstructing their own data structures.</li>
<li>We could still benefit from the existing map functionsâ€¦ provided that we believe it's an advantage. A stricter solution would be to disallow optional map entries completely (and treating records as a separate type).</li>
<li>From a technical point of view, data with a fixed structure can be optimized much better than a structure that changes dynamically.</li>
</ul>
</div></details></div>
<div class="toot" id="created-916"><h2>Pull request #916 created<span class="toot-id"> #created-916</span></h2><div class="pubdate">21 Dec at 17:15:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/916">https://github.com/qt4cg/qtspecs/pull/916</a></div><details><summary>720 Allow methods in maps with access to $this</summary><div class="markup"><p>This proposal allows functions within maps to access the containing map using the variable $this.</p>
<p>The proposal needs editorial work to integrate it fully into the text, but it is intended to be sufficiently complete to enable a full technical review.</p>
<p>Fix #720</p>
</div></details></div>
<div class="toot" id="created-915"><h2>Issue #915 created<span class="toot-id"> #created-915</span></h2><div class="pubdate">21 Dec at 11:45:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/915">https://github.com/qt4cg/qtspecs/issues/915</a></div><details><summary>[Editorial] Incorrect terminology: function implementation is now function body</summary><div class="markup"><p>In 4.6.2.5 Inline Function Expressions we refer to the "implementation" property of a function item; this property has been renamed as the "function body".</p>
</div></details></div>
<div class="toot" id="created-914"><h2>Pull request #914 created<span class="toot-id"> #created-914</span></h2><div class="pubdate">21 Dec at 04:20:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/914">https://github.com/qt4cg/qtspecs/pull/914</a></div><details><summary>XQFO minor edits</summary><div class="markup"><p>From reading up through chap. 13. The change in the title of chap. 10.2 is more accurate, and avoids the repetition of the title of chap. 10 itself.</p>
</div></details></div>
<div class="toot" id="created-913"><h2>Issue #913 created<span class="toot-id"> #created-913</span></h2><div class="pubdate">20 Dec at 23:00:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/913">https://github.com/qt4cg/qtspecs/issues/913</a></div><details><summary>XQFO: under/unused variable apparatus</summary><div class="markup"><p>In the preamble of XQFO chap. 13, several paragraphs are spent introducing a tree structure example, defining variables <code>$po</code>, <code>$item1</code>, <code>$item2</code>, and <code>$item3</code>. The prose leads the reader to expect frequent invocation of this tree example, but chap. 13 never uses it.</p>
<p>Chapter 13's tree example is referred to (sans link) and summarized in the preamble of chap. 14. In that chapter it is used only once, in a <code>fn:count</code> example that really doesn't rely upon anything special in the tree example.</p>
<p>Variables <code>$item1</code> and <code>$item2</code> are invoked only once more: in chap. 4, for <code>fn:number</code>. It's rather out of the blue, because neither the function definition nor chapter 4's preamble say anything about what the variables mean.</p>
<p>My recommendation is to drop this material all together, and for the functions <code>fn:count</code> and <code>fn:number</code> replace the examples with simpler examples.</p>
<p>OTOH, I might have come across an incomplete implementation, and the editors might prefer to make more thorough use of this tree example. I don't know.</p>
</div></details></div>
<div class="toot" id="created-912"><h2>Pull request #912 created<span class="toot-id"> #created-912</span></h2><div class="pubdate">20 Dec at 12:13:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/912">https://github.com/qt4cg/qtspecs/pull/912</a></div><details><summary>XQFO: Minor edits</summary><div class="markup"><p>Editorial; examples fixed</p>
</div></details></div>
<div class="toot" id="closed-297"><h2>Issue #297 closed<span class="toot-id"> #closed-297</span></h2><div class="pubdate">19 Dec at 18:24:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/297">https://github.com/qt4cg/qtspecs/issues/297</a></div><p>Lookup in deeply nested JSON, an abbreviated syntax for map:find</p></div>
<div class="toot" id="closed-20"><h2>Issue #20 closed<span class="toot-id"> #closed-20</span></h2><div class="pubdate">19 Dec at 16:37:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/20">https://github.com/qt4cg/qtspecs/issues/20</a></div><p>Highlight EBNF grammar differences in the diff versions of the specs</p></div>
<div class="toot" id="closed-51"><h2>Issue #51 closed<span class="toot-id"> #closed-51</span></h2><div class="pubdate">19 Dec at 16:37:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/51">https://github.com/qt4cg/qtspecs/issues/51</a></div><p>Generalize lookup operator for function items</p></div>
<div class="toot" id="closed-705"><h2>Issue #705 closed<span class="toot-id"> #closed-705</span></h2><div class="pubdate">19 Dec at 16:37:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/705">https://github.com/qt4cg/qtspecs/issues/705</a></div><p>Function Coercion: Function Arities</p></div>
<div class="toot" id="closed-707"><h2>Issue #707 closed<span class="toot-id"> #closed-707</span></h2><div class="pubdate">19 Dec at 16:37:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/707">https://github.com/qt4cg/qtspecs/issues/707</a></div><p>Dynamic Function Calls: Processing Empty Sequences</p></div></div><p>See 1741
            more statuses in yearly archives.</p></article></main></body></html>