<item>
   <title>Issue #700 created</title>
   <pubDate>2023-09-14T09:06:25Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/700</link>
   <guid>https://qt4cg.org/@qt4cg/2023/#created-700</guid>
   <description>&lt;div&gt;&lt;p&gt;Operators for array mapping and filtering&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;With issue #129 generalising the context item to a context value, we have the opportunity to define context-based mapping and filtering operators for arrays that work in the same way as the &lt;code&gt;A!B&lt;/code&gt; and &lt;code&gt;A[B]&lt;/code&gt; operators for sequences.&lt;/p&gt;
&lt;p&gt;I propose &lt;code&gt;A!!B&lt;/code&gt; as a mapping operator for arrays. Unlike &lt;code&gt;!&lt;/code&gt;, this does not flatten the result. The result is an array whose members correspond one-to-one with the members of &lt;code&gt;A&lt;/code&gt;, each member of the result array being formed by evaluating &lt;code&gt;B&lt;/code&gt; with the corresponding member of &lt;code&gt;A&lt;/code&gt; as the context value.&lt;/p&gt;
&lt;p&gt;For an array whose members are singletons, the expression &lt;code&gt;A!!B&lt;/code&gt; has a similar effect to &lt;code&gt;A?*!B&lt;/code&gt;, but (a) it is clearer, (b) it returns an array rather than a sequence, and (c) it performs no flattening. For the more general case, it can be used in place of the higher-order function call &lt;code&gt;A =&amp;gt; array:for-each(fn{B})&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;I propose &lt;code&gt;A?[B]&lt;/code&gt; as a filter operator for arrays. Unlike &lt;code&gt;A[B]&lt;/code&gt;, this is not overloaded to perform index-based selection. The result is an array containing those members of &lt;code&gt;A&lt;/code&gt; for which &lt;code&gt;B&lt;/code&gt; has an effective boolean value of true, when evaluated with the corresponding member of &lt;code&gt;A&lt;/code&gt; as the context value. The expression &lt;code&gt;$A?[B]&lt;/code&gt; is equivalent to &lt;code&gt;$A =&amp;gt; array:filter(fn{B})&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;For example, &lt;code&gt;$A?[exists(.)]&lt;/code&gt; filters the array &lt;code&gt;$A&lt;/code&gt; to retain only those members that are non-empty.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
