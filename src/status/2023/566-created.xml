<item>
   <title>Issue #566 created</title>
   <pubDate>2023-06-22T11:31:04Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/566</link>
   <guid>https://qt4cg.org/@qt4cg/2023/#created-566</guid>
   <description>&lt;div&gt;&lt;p&gt;fn:parse-uri, fn:build-uri: Feedback&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;Feedback on &lt;code&gt;fn:parse-uri&lt;/code&gt; (thanks, @ndw, for the comprehensible rules in the spec):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;With the current rules, the port is not detected in &lt;code&gt;http://x:80&lt;/code&gt;. Maybe &lt;code&gt;x:&lt;/code&gt; is misinterpreted as the beginning of a Windows path?&lt;/li&gt;
&lt;li&gt;The &lt;em&gt;uri decoding&lt;/em&gt; should be revised. Itâ€™s currently possible to create strings with invalid Unicode characters: &lt;code&gt;parse-uri('%FF')&lt;/code&gt;. With the current rules, the following expression returns &lt;code&gt;df83&lt;/code&gt; and &lt;code&gt;dc00&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;parse-uri('%FF00')
=!&amp;gt; map:get('filepath')
=!&amp;gt; string-to-codepoints()
=!&amp;gt; format-integer('16^XX')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;More to come (or not).&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
