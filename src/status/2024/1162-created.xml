<item>
   <title>Issue #1162 created</title>
   <pubDate>2024-04-18T10:19:44Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1162</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-1162</guid>
   <description>&lt;div&gt;&lt;p&gt;Revert strict type for positional variables (xs:integer → xs:positiveInteger)&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;I feel that the decision to change &lt;code&gt;xs:integer&lt;/code&gt; to &lt;code&gt;xs:positiveInteger&lt;/code&gt; was a bit hasty (https://github.com/qt4cg/qtspecs/pull/1131#issuecomment-2051379262):&lt;/p&gt;
&lt;p&gt;To be consistent, numerous other expressions and functions would need to be rewritten as well to use stricter types (arbitrary examples: the &lt;code&gt;count&lt;/code&gt; clause; &lt;code&gt;$err:line-number&lt;/code&gt; in the catch clause; the result type of &lt;code&gt;fn:string-to-codepoints&lt;/code&gt;; positions in &lt;code&gt;array:get&lt;/code&gt;, &lt;code&gt;fn:parse-integer&lt;/code&gt;, etc.; the position parameter in HOF functions, and so on and on). We haven’t done so yet, and I seriously wonder what exactly we would win from the stricter types. In many cases, it would be reasonable to also define a strict upper limit, which is not possible with our types anyway.&lt;/p&gt;
&lt;p&gt;Implementations may build heavily on the fact that &lt;code&gt;xs:integer&lt;/code&gt; has been the default type for integer values in previous versions of the languages. For example, we use cached instances for the most small integer values, or we rewrite constructs with &lt;code&gt;xs:integer&lt;/code&gt; to other constructs accepting the same type.&lt;/p&gt;
&lt;p&gt;For all these challenges, as always, technical solutions exist, but the question is if there aren’t more interesting things to focus on than on such corner cases. Queries like &lt;code&gt;count(1 to 1000000000000)&lt;/code&gt; are not supported by all implementations either although they may appear trivial to the ordinary user (by coincidence, it’s supported by BaseX, but I doubt it has been used a lot).&lt;/p&gt;
&lt;p&gt;In short, I would like us to revert the change in https://github.com/qt4cg/qtspecs/pull/1131/commits/bba6e4f1067e0ef0779688622a58320a5298d440 and stick with &lt;code&gt;xs:integer&lt;/code&gt;. If people feel bad about it, I would suggest discussing strict types in a much broader and general way.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
