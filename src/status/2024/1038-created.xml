<item>
   <title>Issue #1038 created</title>
   <pubDate>2024-02-21T21:03:41Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1038</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-1038</guid>
   <description>&lt;div&gt;&lt;p&gt;Backwards incompatibility caused by use of EBV in callback functions&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;Changing fn:filter and similar functions that existed in 3.1 to use the EBV of the callback function's result has introduced a backwards incompatibility. In 3.1, the function conversion rules were used to convert the callback function's result to &lt;code&gt;xs:boolean&lt;/code&gt;. This involves atomization. If the callback returned the untyped node &lt;code&gt;&amp;lt;a&amp;gt;false&amp;lt;/a&amp;gt;&lt;/code&gt;, this is atomised as &lt;code&gt;false()&lt;/code&gt;, but its EBV is &lt;code&gt;true()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Revealed by test case fn:filter-006.&lt;/p&gt;
&lt;p&gt;I think it's unlikely to happen much in practice, but it's a bit nasty. Perhaps we shouldn't make the change to use EBV for functions that existed in 3.1?&lt;/p&gt;
&lt;p&gt;Perhaps we should even consider reverting the change entirely. It's not exactly essential.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
