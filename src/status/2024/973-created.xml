<item>
   <title>Issue #973 created</title>
   <pubDate>2024-01-29T12:24:20Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/973</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-973</guid>
   <description>&lt;div&gt;&lt;p&gt;fn:parse-json, fn:json-to-xml: `number-parser`, `fallback`&lt;/p&gt;&lt;div class="markup"&gt;&lt;ol&gt;
&lt;li&gt;See #33: &lt;code&gt;number-parser&lt;/code&gt; option needs to be added to &lt;code&gt;fn:json-to-xml&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Similar to &lt;code&gt;fn:replace&lt;/code&gt;, I would suggest using &lt;code&gt;function(xs:untypedAtomic) as item()?)&lt;/code&gt; as signature for both the &lt;code&gt;fallback&lt;/code&gt; and the &lt;code&gt;number-parser&lt;/code&gt; option, and (for &lt;code&gt;fallback&lt;/code&gt;) to invoke &lt;code&gt;fn:string#1&lt;/code&gt; on the result. This way, explicit casts in the code get obsolete. Queries like the following one…&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;parse-json(
  '-123',
  map { 'number-parser': fn($n) { $n =&amp;gt; number() =&amp;gt; abs() }
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;…can then be simplified to &lt;code&gt;parse-json('-123', abs#1)&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
