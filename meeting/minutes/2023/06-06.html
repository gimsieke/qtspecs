<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 037 Minutes 2023-05-30</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 037 Minutes 2023-05-30</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/12]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[8/12]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a>
<ul>
<li><a href="#so-far">1.2.1. Status so far…</a></li>
</ul>
</li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[1/11]</code></a></li>
<li><a href="#open-pull-requests">1.6. Review of open pull requests</a></li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-521">2.1. PR #521: 518: Add transitive-closure() function</a></li>
<li><a href="#pr-512">2.2. PR #512: 256: Context for default function parameter expressions</a></li>
<li><a href="#pr-529">2.3. PR #529: 528: revision of json(), and renaming to xdm-to-json()</a></li>
<li><a href="#pr-368">2.4. PR #368: 129: Context item generalized to context value</a></li>
<li><a href="#pr-533">2.5. PR #533 Spec for CSV parsing with fn:parse-csv()</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business?</a></li>
<li><a href="#adjourned">4. Adjourned</a></li>
</ul>
</div>
</div>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/12]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-026-01: MK to write a summary paper that outlines the decisions we need to make on “value sequences”
<ul class="org-ul">
<li>This is related to PR #368: Issue 129 - Context item generalized to context value and
subsequent discussion.</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-01: RD+DN to draft spec prose for the “divide and conquer” approach outlined in issue #399</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-07: NW to open the next discussion of #397 with a demo from DN
See PR <a href="https://qt4cg.org/dashboard/#pr-449">#449</a></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-035-01: CG to make a few more (slightly more complex) <code>map:keys</code> examples.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-035-02: CG to fix the type signature and examples in <code>map:filter</code>.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-036-01: NW to draft a PR to resolve issue #414 along the lines MK proposed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-036-02: MK to revise function identity following the discussion in meeting 036.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-036-03: MK to revise PR #521 following the discussion in meeting 036.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-037-01: NW to ask group if they’d like to take a summer holiday</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-037-02: MK to consider access to static variables in default function parameter expressions (and maybe everything possible in <code>use-when</code>).</li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[8/12]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets BTW, CG.
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Anthony (Tony) Bufort (AB)</li>
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="off"><code>[&#xa0;]</code> Christian Grün (CG)</li>
<li class="off"><code>[&#xa0;]</code> Joel Kalvesmaki (JK)</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> John Lumley (JL)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM)</li>
<li class="off"><code>[&#xa0;]</code> Bethan Tovey-Walsh (BTW)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2023/06-06.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>

<div id="outline-container-so-far" class="outline-4">
<h4 id="so-far"><span class="section-number-4">1.2.1.</span> Status so far…</h4>
<div class="outline-text-4" id="text-so-far">

<div id="orgaff7df8" class="figure">
<p><img src="./issues-open-2023-06-06.png" alt="issues-open-2023-06-06.png" />
</p>
<p><span class="figure-number">Figure 1: </span>“Burn down” chart on open issues</p>
</div>


<div id="orgacd9570" class="figure">
<p><img src="./issues-by-spec-2023-06-06.png" alt="issues-by-spec-2023-06-06.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Open issues by specification</p>
</div>


<div id="org42c3e5c" class="figure">
<p><img src="./issues-by-type-2023-06-06.png" alt="issues-by-type-2023-06-06.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Open issues by type</p>
</div>
</div>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2023/05-30.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting <a href="../../agenda/2023/06-13.html">is scheduled for Tuesday, 13 June 2023</a>.
</p>

<p>
CG gives regrets for 13 June.
</p>

<p>
ACTION QT4CG-037-01: NW to ask group if they’d like to take a summer holiday
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[1/11]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-026-01: MK to write a summary paper that outlines the decisions we need to make on “value sequences”
<ul class="org-ul">
<li>This is related to PR #368: Issue 129 - Context item generalized to context value and
subsequent discussion.</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-01: RD+DN to draft spec prose for the “divide and conquer” approach outlined in issue #399</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-07: NW to open the next discussion of #397 with a demo from DN
See PR <a href="https://qt4cg.org/dashboard/#pr-449">#449</a></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-035-01: CG to make a few more (slightly more complex) <code>map:keys</code> examples.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-035-02: CG to fix the type signature and examples in <code>map:filter</code>.</li>
<li class="on"><code>[X]</code> QT4CG-035-03: NW to attempt to draft a PR that allows xs:string to be promoted to xs:anyURI</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-036-01: NW to draft a PR to resolve issue #414 along the lines MK proposed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-036-02: MK to revise function identity following the discussion in meeting 036.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-036-03: MK to revise PR #521 following the discussion in meeting 036.</li>
</ul>
</div>
</div>

<div id="outline-container-open-pull-requests" class="outline-3">
<h3 id="open-pull-requests"><span class="section-number-3">1.6.</span> Review of open pull requests</h3>
<div class="outline-text-3" id="text-open-pull-requests">
<p>
The following editorial or otherwise minor PRs were open when this
agenda was prepared.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-535">#535</a>: Editorial: add an entry to the changes appendix</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-534">#534</a>: 530: escape solidus in JSON</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-532">#532</a>: fix error in LambdaParams rule</li>
</ul>

<p>
Proposal: Accept these PRs.
</p>

<p>
Accepted.
</p>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
</div>

<div id="outline-container-pr-521" class="outline-3">
<h3 id="pr-521"><span class="section-number-3">2.1.</span> PR #521: 518: Add transitive-closure() function</h3>
<div class="outline-text-3" id="text-pr-521">
<ul class="org-ul">
<li>See PR <a href="https://qt4cg.org/dashboard/#pr-521">#521</a></li>
</ul>

<p>
We talked about this last week…it needs a new PR before it can be progressed.
</p>

<p>
Deferred.
</p>
</div>
</div>

<div id="outline-container-pr-512" class="outline-3">
<h3 id="pr-512"><span class="section-number-3">2.2.</span> PR #512: 256: Context for default function parameter expressions</h3>
<div class="outline-text-3" id="text-pr-512">
<ul class="org-ul">
<li>See PR <a href="https://qt4cg.org/dashboard/#pr-512">#512</a></li>
</ul>

<p>
Mike leads us through the PR.
</p>

<ul class="org-ul">
<li>MK: I tried once before, but it was an ugly design so I’ve revisited it.
<ul class="org-ul">
<li>… What this PR does is define ab initio a static and dynamic
context for evaluation of default parameter expressions.</li>
<li>… It’s a stripped down context without all the awkward bits.</li>
<li>… Start by looking at XQuery:
<ul class="org-ul">
<li>… Moved the default collation into the dynamic context</li>
<li>… It’s known statically, but it’s needed when the function is
called so it makes sense to move it into the dynamic context.</li>
<li>… Tried to tidy up a bit of patching done in the 3.1 spec about
the static base URI.</li>
<li>… Static context has a static base URI and the dynamic context
has the executable base URI.</li>
<li>… Ugly but necessary: the static-base-uri() function returns the
executable base URI.</li>
</ul></li>
</ul></li>
</ul>

<p>
Some discussion of why this is all necessary. For defining default
function parameter expressions, we have a hole in the spec. We could
say it has to be a literal and not context dependent. But one reason
we allow it is to allow user functions to work like system functions
where the context or the default collation can be given as a default.
</p>

<ul class="org-ul">
<li>DN: Why do we need to move the collation from the static to the
dynamic context?</li>
<li>MK: Because, for example, if you look at deep-equal, the collation
argument defaults to the default collation of the caller. Not the
context of the function declaration. So if you define your own
function that’s a bit like deep equals, then you need access to the
default collation of the context of the caller.</li>
<li>RD: Or if you were defining the functions in XQuery itself.</li>
</ul>

<p>
Mike returns to the review.
</p>

<ul class="org-ul">
<li>MK: A few small fixes.</li>
<li>MK: We also have changes to function declarations:
<ul class="org-ul">
<li>… It all looks as if it’s changed, but mostly I’ve just moved the
paragraphs around a bit and divided them into subsections. There’s
very little technical change.</li>
<li>… The substantive part is the change related to the default value.</li>
</ul></li>
<li>RD: What does “user defined functions” mean here?</li>
<li>MK: It means what 5.18.1 says; it should be a termref.</li>
</ul>

<p>
Some additional discussion of what the definition of “user defined
function” means.
</p>

<ul class="org-ul">
<li>MK: Again, a lot of text has been rearranged.</li>
<li>MK: It’s basically the same rules in XSLT; slightly adapted because
we have packages and other things. But the intent is the same.</li>

<li>JL: We now have static-base-uri and you can execute it in two
manners, at compile time and runtime. Is it worth giving the compile
time version a different name.</li>
<li>MK: We say “during static analysis” in the spec.</li>
<li>JL: In XSLT, are you permitted to make a default that includes a
static variable?</li>
<li>MK: That’s a good question. Let’s look at the XSLT spec.
<ul class="org-ul">
<li>… No, it currently bans reference to static variables.</li>
</ul></li>
<li>JL: I could imagine a few cases where you might want to parameterize
at the top level. And I can’t see why you shouldn’t be allowed.</li>

<li>MSM: Can we generalize that and say “anything you can use in a
~use-when~” should be allowed?</li>
<li>MK: I’d have to check in detail.</li>

<li>MSM: Right, but as a consumer I will say that every difference will
be painful at some point.
<ul class="org-ul">
<li>… If I can do it in a <code>use-when</code>, I’ll be surprised if I can’t do it
when defining a default.</li>
</ul></li>
</ul>

<p>
ACTION QT4CG-037-02: MK to consider access to static variables in default function parameter expressions (and maybe everything possible in <code>use-when</code>).
</p>

<ul class="org-ul">
<li>MSM: I think that description of the reason we have to move the
default collation to the dynamic context is essentially that when we
think about separate compilation, this more like wanting dynamic
scoping than static scoping.</li>
<li>MK: I think the high level is that you want to pick up the collation
of the caller of the function rather than the declaration. The
caller is dynamic.</li>
<li>MSM: I’m finding it difficult to get my head around the logic that
says that fn:static-base-uri should return the executable base URI.
That seems like asking for trouble.</li>
<li>MK: Yes. That’s because static-base-uri is a function that you
evaluate dynamically.</li>
<li>MSM: Why?</li>
<li>MK: A typical use case is if you have a lookup document that lives
alongside the stylesheet and you want to access relative to the
stylesheet, you use resolve-uri against the static-base-uri. So they
think it’s giving something next door to the stylesheet. But that
will be where it’s deployed at runtime.</li>
<li>MSM: I find the whole slippery problem of base URIs sometimes
misleading.</li>
<li>MK: The documentation is all written to try to abstract away from
the specific details of the execution environment. That makes it
very hard to work out what it really means in terms of a concrete
implementation.</li>
<li>MSM: I wonder if what we need to do is rename the existing static
base URI rather than the new one.</li>
<li>MK: Maybe a new function and say the old one is deprecated.</li>
<li>MSM: Yes, the long term cost of having a function name that doesn’t
correspond to the property it returns is a cost we’ll pay forever.</li>
<li>DN: I was under the impression that we said nothing could prevent
users from defining functions in the default namespace.</li>
<li>MK: I believe both XSLT and XQuery make our namespaces reserved so
you can’t put functions in them.</li>
<li>DN: Okay. I think that build-time and deploy-time would be better
names for the static URI functions.</li>
<li>DN: Imagine that the dynamic context has no value for the default
collation, shouldn’t it then be taken from the static context?
That’s why I thought it should be present in the static context
also.</li>
<li>MK: It would be awfully nice if there was a really clean distinction.
<ul class="org-ul">
<li>… The current situation in both XQuery and XSLT is that you can
work out statically for any expression what default collation it’s
going to use.</li>
<li>… But that’s not necessarily true of ever host language that
someone might use. On can imagine facilities that would allow you
to set the default collation at runtime.</li>
<li>… In a sense that’s what we’re doing by allowing you to pick up
the default collation of the caller.</li>
</ul></li>
<li>DN: I understand that it’s useful to have the default collation in
the dynamic context, but why remove it from the static context?</li>
<li>MK: Because there’s no static operation that makes use of it. Unlike
static-base-uri, which is used by xsl:import or xsl:include.</li>
</ul>

<p>
Some discussion of how these terms are defined and used and how the
compile time and runtime environments are related.
</p>

<ul class="org-ul">
<li>DN: Althoug we have this default collation known statically, it is
always first moved to the dynamic context before evaluation.</li>
<li>MK: Obviously there can be optimizations that take advantage of the
fact that you know it in advance, but they’re only optimizations.</li>
<li>JL: But in XSLT, can’t the compiler use the static default
collation? For example, deep equal.</li>
<li>MK: The comparison of whether the two things are equal is done at
runtime.</li>
<li>JL: What about if they’re static?</li>
<li>MK: Static expressions have their own <b>dynamic</b> context.</li>
<li>DN: Maybe we need a better explanation of static base URIs and
default collations.</li>
<li>MK: The challenge isn’t writing the text, it’s putting it somewhere
that people will find it.</li>
</ul>

<p>
Proposal: accept this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-529" class="outline-3">
<h3 id="pr-529"><span class="section-number-3">2.3.</span> PR #529: 528: revision of json(), and renaming to xdm-to-json()</h3>
<div class="outline-text-3" id="text-pr-529">
<ul class="org-ul">
<li>See PR <a href="https://qt4cg.org/dashboard/#pr-529">#529</a></li>

<li>MK: I’ve spent a great deal of time over the last week, specifying a
function called <code>xdm-to-json()</code> to allow an XDM value to be
converted to JSON. It’s a significant challenge because the aim is
to do as good a job on simple cases without making a complete mess
out of complicated cases.
<ul class="org-ul">
<li>… To achieve a simple result, you sometimes need a complicated
specification.</li>
<li>… I believe I’ve delivered a specification, an implementation, and
a test suite with 150 tests in it.</li>
<li>… You might find it useful to look at the tests first.</li>
<li>… What I’d really like is for a couple of people to look at it in
detail and see what works.</li>
</ul></li>
<li>DN: I believe that this is really important work. Is this function
implementing a 1:1 mapping or not?</li>
<li>MK: No, it doesn’t attempt to be lossless or reversible.</li>
</ul>

<p>
Some discussion of the draft of <code>fn:json</code> that was in an earlier
draft. That’s been largely replaced.
</p>
</div>
</div>

<div id="outline-container-pr-368" class="outline-3">
<h3 id="pr-368"><span class="section-number-3">2.4.</span> PR #368: 129: Context item generalized to context value</h3>
<div class="outline-text-3" id="text-pr-368">
<ul class="org-ul">
<li>See PR <a href="https://qt4cg.org/dashboard/#pr-368">#368</a></li>
</ul>

<p>
This PR needs to be revised before discussion.
</p>
</div>
</div>

<div id="outline-container-pr-533" class="outline-3">
<h3 id="pr-533"><span class="section-number-3">2.5.</span> PR #533 Spec for CSV parsing with fn:parse-csv()</h3>
<div class="outline-text-3" id="text-pr-533">
<ul class="org-ul">
<li>See PR <a href="https://qt4cg.org/dashboard/#pr-533">#533</a></li>
</ul>

<p>
Plan to invite Matt for this discussion.
</p>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business?</h2>
<div class="outline-text-2" id="text-any-other-business">
<p>
None heard.
</p>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">4.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
</div>
</div>
</div>
</body>
</html>