<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 075 Minutes 2024-04-30</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 075 Minutes 2024-04-30</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/5]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[10/12]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a>
<ul>
<li><a href="#so-far">1.2.1. Status so far…</a></li>
</ul>
</li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[3/7]</code></a></li>
<li><a href="#open-pull-requests">1.6. Review of open pull requests and issues</a>
<ul>
<li><a href="#merge-without-discussion">1.6.1. Merge without discussion</a></li>
<li><a href="#close-without-action">1.6.2. Close without action</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-1177">2.1. PR #1177: 1162 Positional variables are xs:integer not xs:positiveInteger</a></li>
<li><a href="#pr-1174">2.2. PR #1174: 1173 array:build, map:build: Positional access</a></li>
<li><a href="#pr-1168">2.3. PR #1168: 1166 Clarify rule on invalid option keys</a></li>
<li><a href="#pr-1148">2.4. PR #1148: 1143 Coercion rules: handle choice types before atomization</a></li>
<li><a href="#pr-1117">2.5. PR #1117: 1116 Add options param to unparsed-text</a></li>
<li><a href="#pr-1087">2.6. PR #1087: 1086 Editorial changes to array:values</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business</a></li>
<li><a href="#adjourned">4. Adjourned</a></li>
</ul>
</div>
</div>
<p>
<a href="../">Meeting index</a> / <a href="https://qt4cg.org">QT4CG.org</a> / <a href="https://qt4cg.org/dashboard">Dashboard</a> / <a href="https://github.com/qt4cg/qtspecs/issues">GH Issues</a> / <a href="https://github.com/qt4cg/qtspecs/pulls">GH Pull Requests</a>
</p>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/5]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-063-06: MK to consider refactoring the declare item type syntax to something like declare record</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-071-06: NW to clarify the cases that are distinguished by the leading empty string in path segments</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-072-03: NW to clarify the round-tripping of URIs</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-073-01: NW to proceed with the records/options proposal and make a PR.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-075-01: MK to drop the deterministic option and raise it as a separate issue.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-075-02: MK to define sequence-concatenation more formally with links where appropriate</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-075-03: CG to make changes to <code>map:values</code> analagous to MK’s changes to <code>array:values</code></li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[10/12]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets: JLO
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Reece Dunn (RD) [x:15-]</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="off"><code>[&#xa0;]</code> Joel Kalvesmaki (JK)</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="off"><code>[&#xa0;]</code> Juri Leino (JLO)</li>
<li class="on"><code>[X]</code> John Lumley (JLY)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Wendell Piez (WP)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2024/04-30.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>

<div id="outline-container-so-far" class="outline-4">
<h4 id="so-far"><span class="section-number-4">1.2.1.</span> Status so far…</h4>
<div class="outline-text-4" id="text-so-far">

<div id="org652ee3d" class="figure">
<p><img src="./issues-open-2024-04-30.png" alt="issues-open-2024-04-30.png" />
</p>
<p><span class="figure-number">Figure 1: </span>“Burn down” chart on open issues</p>
</div>


<div id="org46ad288" class="figure">
<p><img src="./issues-by-spec-2024-04-30.png" alt="issues-by-spec-2024-04-30.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Open issues by specification</p>
</div>


<div id="org7fb5b34" class="figure">
<p><img src="./issues-by-type-2024-04-30.png" alt="issues-by-type-2024-04-30.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Open issues by type</p>
</div>
</div>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2024/04-23.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting <a href="../../agenda/2024/05-07.html">is scheduled for Tuesday, 7 May 2024</a>.
</p>

<p>
JLY gives regrets. NW gives regrets, MSM to chair.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[3/7]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-063-06: MK to consider refactoring the declare item type syntax to something like declare record</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-071-06: NW to clarify the cases that are distinguished by the leading empty string in path segments</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-072-03: NW to clarify the round-tripping of URIs</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-073-01: NW to proceed with the records/options proposal and make a PR.</li>
<li class="on"><code>[X]</code> QT4CG-074-01: MK to remove default values from variadic arguments</li>
<li class="on"><code>[X]</code> QT4CG-074-02: DN to create an issue about allowing function arguments to have default values</li>
<li class="on"><code>[X]</code> QT4CG-074-03: MK to add variadic functions to the XSLT specification</li>
</ul>
</div>
</div>

<div id="outline-container-open-pull-requests" class="outline-3">
<h3 id="open-pull-requests"><span class="section-number-3">1.6.</span> Review of open pull requests and issues</h3>
<div class="outline-text-3" id="text-open-pull-requests">
</div>

<div id="outline-container-merge-without-discussion" class="outline-4">
<h4 id="merge-without-discussion"><span class="section-number-4">1.6.1.</span> Merge without discussion</h4>
<div class="outline-text-4" id="text-merge-without-discussion">
<p>
The following PRs are editorial, small, or otherwise appeared to be
uncontroversial when the agenda was prepared. The chairs propose that
these can be merged without discussion. If you think discussion is
necessary, please say so.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1178">#1178</a>: 1146 Add inline change markup in the XPath/XQuery spec</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1137">#1137</a>: 161 Variadic functions</li>
</ul>

<p>
Proposal: Merge without discussion.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-close-without-action" class="outline-4">
<h4 id="close-without-action"><span class="section-number-4">1.6.2.</span> Close without action</h4>
<div class="outline-text-4" id="text-close-without-action">
<p>
It has been proposed that the following issues be closed without action.
If you think discussion is necessary, please say so.
</p>

<ul class="org-ul">
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/553">#553</a>: New function fn:substitute()</li>
</ul>

<p>
Proposal: Close without further action.
</p>

<p>
Accepted.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
</div>

<div id="outline-container-pr-1177" class="outline-3">
<h3 id="pr-1177"><span class="section-number-3">2.1.</span> PR #1177: 1162 Positional variables are xs:integer not xs:positiveInteger</h3>
<div class="outline-text-3" id="text-pr-1177">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1177">#1177</a>
</p>

<ul class="org-ul">
<li>MK: This rolls back to using xs:integer for positional variables.</li>
<li>MSM: They <b>are</b> always positive (or non-negative) integers. So this is just about consistency.</li>
<li>MK: Yes, but also in what type annotations we assign to the variables.</li>
<li>MSM: And interactions with other rules.</li>
</ul>

<p>
Proposal: Accept this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-1174" class="outline-3">
<h3 id="pr-1174"><span class="section-number-3">2.2.</span> PR #1174: 1173 array:build, map:build: Positional access</h3>
<div class="outline-text-3" id="text-pr-1174">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1174">#1174</a>
</p>

<ul class="org-ul">
<li>CG: This is a minor one. We have a bunch of functions with optional positional
argumements. I’ve added that in places where it was missing.
<ul class="org-ul">
<li>… I’ve done this for <code>array:build</code> and <code>map:build</code>.</li>
</ul></li>
<li>MSM: How are <code>$name</code> and <code>$pos</code> are bound how?</li>
<li>CG: The names are up to you.</li>
<li>MSM: So I could use any name I wanted?</li>
<li>CG: Yes.</li>
<li>MK: You have to supply a function with the right signature, but the names
aren’t part of the signature.</li>
<li>DN: We are starting to use abbreviations, this is a little bit concerning. If
the reader isn’t a native speaker of English, sometimes the abbreviations can
be hard to understand. I think I previously raised the problem that we
shouldn’t mechanically put this new position argument everywhere. For example,
for folds, this is meaningless. A few languages, like JavaScript, have put a
position argument in fold. But I didn’t find any places where the argument was
useful.</li>
<li>CG: I just had a user that was using position in a fold. I asked them why and
the reason is because it’s available in JavaScript.</li>
</ul>

<p>
Some discussion of the use of position in fold.
</p>

<ul class="org-ul">
<li>JLY: Related to this, in anonymous functions, can you use named arguments?
<ul class="org-ul">
<li>… For example, if I’d used <code>$keys</code> in this example.</li>
</ul></li>
<li>MK: Not in dynamic function calls.</li>
<li>CG: That’s currently being discussed, but it would have many implications.</li>
<li>SF: The same callbacks could be reused multiple times. Keeping the signatures
the same across different collection methods is key for reusability.</li>
<li>MK: Anyone who’s used XSLT in the last 25 years has almost certainly used the
<code>position()</code> function inside a for-each. We’ve all encountered places where
you want to iterate and know the position. It’s hard to anticipate if there’s
a use case for this particular function, but if you leave it out, someone will
want it.
<ul class="org-ul">
<li>… With respect to map order, here we’re iterating over a sequence. The
argument to map-build is a sequence, so there is an order.</li>
</ul></li>
</ul>

<p>
Proposal: Accept this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-1168" class="outline-3">
<h3 id="pr-1168"><span class="section-number-3">2.3.</span> PR #1168: 1166 Clarify rule on invalid option keys</h3>
<div class="outline-text-3" id="text-pr-1168">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1168">#1168</a>
</p>

<ul class="org-ul">
<li>MK: This is a minor wording change to make the rules clear.</li>
</ul>

<p>
MK revues the change to item 5 in the list.
</p>

<ul class="org-ul">
<li>MK: Implementors can add ordinary string options if they want, but they risk
other rejecting it. If you want to avoid that, use QNames with a namespace.</li>
</ul>

<p>
MK reviews another change that CG highlighted, in bullet 8, clarifying when
arrays are allowed.
</p>

<p>
Proposal: Accept this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-1148" class="outline-3">
<h3 id="pr-1148"><span class="section-number-3">2.4.</span> PR #1148: 1143 Coercion rules: handle choice types before atomization</h3>
<div class="outline-text-3" id="text-pr-1148">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1148">#1148</a>
</p>

<ul class="org-ul">
<li>MK: This PR is still blocked. I’ve spent an hour or two trying to unblock it.
It’s blocked by conflicts and there seem to be deeper semantic issues. The
structure and ordering and vocabulary wasn’t clear enough.
<ul class="org-ul">
<li>… I’ll bring it back next week.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-pr-1117" class="outline-3">
<h3 id="pr-1117"><span class="section-number-3">2.5.</span> PR #1117: 1116 Add options param to unparsed-text</h3>
<div class="outline-text-3" id="text-pr-1117">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1117">#1117</a>
</p>

<ul class="org-ul">
<li>MK: Fair warning, I made a change to this PR this morning…</li>
</ul>

<p>
MK reviews the changes to <code>fn:unparsed-text()</code>. Changes are to the second argument.
</p>

<ul class="org-ul">
<li>MK: There’s some room for discussion on the new <code>deterministic</code> option.
<ul class="org-ul">
<li>… In a deterministic implementation, you have to cache.</li>
</ul></li>
<li>NW: Seems odd to add it here when it would be just as useful on things like <code>fn:doc()</code>.</li>
<li>MK: Yes, the idea is to do this in more places.</li>
<li>JLY: Does this implementation determines that it’s false, does that mean you can’t inline it?</li>
<li>MK: If deterministic is true, you have to deliver consistent results, but all
bets are all off if you specify deterministic is false.</li>
<li>RD: You could treat deterministic=false as determinstic=true but not vice-versa.</li>
<li>DN: I understand what deterministic means here, but it’s totally confusing.
From all other definitions of deterministic it’s about the function.</li>
<li>MK: No, that is what it means.</li>
<li>DN: It isn’t the <b>function</b> that’s deterministic, …</li>
</ul>

<p>
Some discussion about what deterministic means in this case. There’s confusion
about the phrasing of “multiple calls” in the table.
</p>

<ul class="org-ul">
<li>CG: I think it’s a good idea to make the function non-deterministic by default. 
<ul class="org-ul">
<li>… I’m not sure I like having deterministic as an option that you can’t resolve until runtime.</li>
<li>… I also think it’s confusing if you create a function that uses different
values for deterministic. It’s not clear what happens if you call it once
with true and then again with false.</li>
<li>… Determinism has also always been a low-level property of functions. It
seems like a very essential change to make this dynamic. Couldn’t there be
other ways to do this? If we had a more global approach, then we could have
all the functions effected.</li>
</ul></li>
<li>MK: There are some very good arguments there. I do think there are use cases
that depend on the resource you’re using. You might want reading a lookup
table of tax rates to be deterministic where reading something else you want
it to be non-deterministic. I think there are use cases for a
resource-by-resource basis.
<ul class="org-ul">
<li>… I accept that making it completely dynamic like this, we have to address
what it means for different calls that have different values for deterministic.</li>
<li>… With respect to the default, I went with the conservative approach.</li>
</ul></li>
<li>CG: Would it be possible to have different functions?</li>
<li>MK: Mulitiplying the number of functions that way doesn’t enormously appeal to
me. You could have a modifier function to get non-deterministic variants.</li>
<li>DN: We’ll have the same problem with any function that produces results from
the outside world. This is probably not the best name. Maybe “repeatable
result” or something. “Mutable” or “immutable.”</li>
<li>WP: Isn’t this the same or opposite of memoizable?</li>
<li>MK: That’s slightly different in that if you have a deterministic function, then memoization
only effect it’s performance.</li>
<li>RD: The way that this is solved in databases like MarkLogic is through
transactions. A commit-rollback style approach. Anything within a given
transaction is set in stone for the duration of that transaction.
<ul class="org-ul">
<li>… Does it make sense to consider if determinism can be sorted out at a
broader level rather than function by function.</li>
</ul></li>
<li>DN: There are many options here.</li>
<li>CG: Should we remove the deterministic option for now?</li>
<li>MK: Reverting to the status quo and leaving it up to the implementor is
probably best until we have a way forward.</li>
<li>DN: I think that the right approach would be to have particular use cases and
to try to find the right solution for them. For example, one use case is that
this code posts to a resource and then access the resource and we want to see
the result of the post reflected.</li>
<li>JLY: The analogy I have is with current time. Saxon has two different
versions, one that’s fixed and one that isn’t.</li>
<li>EP: Maybe this would make more sense to be placed at the stylesheet or some
sort of “phase” level so that you could control it across all the functions.</li>
</ul>

<p>
ACTION QT4CG-075-01: MK to drop the deterministic option and raise it as a separate issue.
</p>

<p>
Agreed.
</p>
</div>
</div>

<div id="outline-container-pr-1087" class="outline-3">
<h3 id="pr-1087"><span class="section-number-3">2.6.</span> PR #1087: 1086 Editorial changes to array:values</h3>
<div class="outline-text-3" id="text-pr-1087">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1087">#1087</a>
</p>

<ul class="org-ul">
<li>MK: I think this is pretty minor in comparison.</li>
</ul>

<p>
MK reviews the changes to <code>array:values</code> in the PR.
</p>

<ul class="org-ul">
<li>MK: Very minor changes.</li>
<li>CG: Maybe we should also do this to <code>map:values</code>? We also want to try to
harmonize them.</li>
<li>DN: In the summary, what does “sequence-concatenation” mean?</li>
<li>MK: Yes, it should be a defined term.</li>
<li>RD: It’s defined in XPath and XQuery.</li>
<li>MK: Yes, it should be linked.</li>
<li>CG: I wonder if we could add a note on the <code>$array*</code> for usability.</li>
</ul>

<p>
ACTION QT4CG-075-02: MK to define sequence-concatenation more formally with links where appropriate
</p>

<p>
ACTION QT4CG-075-03: CG to make changes to <code>map:values</code> analagous to MK’s changes to <code>array:values</code>
</p>

<p>
Proposal: accept this PR
</p>

<p>
Accepted.
</p>

<ul class="org-ul">
<li>RD: I don’t see a specific definition of the phrase “sequence-concatenation”.
There’s discussion of the comma operator.</li>
<li>MK: Making a formal definition is a bit tricky, but I’ll try.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business</h2>
<div class="outline-text-2" id="text-any-other-business">
<p>
None heard.
</p>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">4.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
</div>
</div>
</div>
</body>
</html>
