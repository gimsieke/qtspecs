<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 061 Minutes 2024-01-16</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 061 Minutes 2024-01-16</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/4]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[8/11]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a>
<ul>
<li><a href="#so-far">1.2.1. Status so far…</a></li>
</ul>
</li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[7/10]</code></a></li>
<li><a href="#open-pull-requests">1.6. Review of open pull requests and issues</a>
<ul>
<li><a href="#blocked">1.6.1. Blocked</a></li>
<li><a href="#merge-without-discussion">1.6.2. Merge without discussion</a></li>
<li><a href="#xslt-focused">1.6.3. XSLT focused</a></li>
<li><a href="#substantive">1.6.4. Substantive PRs</a></li>
<li><a href="#proposed-40">1.6.5. Proposed for V4.0</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-927">2.1. PR #927: 861 Rewrite spec of deep lookup operator</a></li>
<li><a href="#pr-916">2.2. PR #916: 720 Allow methods in maps with access to $this</a></li>
<li><a href="#pr-832">2.3. PR #832: 77 Add map:deep-update and array:deep-update</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business?</a></li>
<li><a href="#adjourned">4. Adjourned</a></li>
</ul>
</div>
</div>
<p>
<a href="../">Meeting index</a> / <a href="https://qt4cg.org">QT4CG.org</a> / <a href="https://qt4cg.org/dashboard">Dashboard</a> / <a href="https://github.com/qt4cg/qtspecs/issues">GH Issues</a> / <a href="https://github.com/qt4cg/qtspecs/pulls">GH Pull Requests</a>
</p>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/4]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-052-02: NW to consider how to schedule an “editor’s meeting”</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-056-04: MK to write a proposal for adding a select attribute to xsl:text</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-058-02: MK to consider providing more advice about the pitfalls of mixing decimal and double when sorting</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-061-01: MK to review the comments CG made on the PR #927.
<ul class="org-ul">
<li>NW to merge PR #927 after MK review</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[8/11]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets: MSM, JK.
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="off"><code>[&#xa0;]</code> Joel Kalvesmaki (JK)</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> John Lumley (JL)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Wendell Piez (WP) [:10-]</li>
<li class="off"><code>[&#xa0;]</code> Ed Porter (EP)</li>
<li class="off"><code>[&#xa0;]</code> C. M. Sperberg-McQueen (MSM)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2024/01-16.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>

<div id="outline-container-so-far" class="outline-4">
<h4 id="so-far"><span class="section-number-4">1.2.1.</span> Status so far…</h4>
<div class="outline-text-4" id="text-so-far">

<div id="org9b0191b" class="figure">
<p><img src="./issues-open-2024-01-16.png" alt="issues-open-2024-01-16.png" />
</p>
<p><span class="figure-number">Figure 1: </span>“Burn down” chart on open issues</p>
</div>


<div id="orge86283e" class="figure">
<p><img src="./issues-by-spec-2024-01-16.png" alt="issues-by-spec-2024-01-16.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Open issues by specification</p>
</div>


<div id="org5a7576e" class="figure">
<p><img src="./issues-by-type-2024-01-16.png" alt="issues-by-type-2024-01-16.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Open issues by type</p>
</div>
</div>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2024/01-09.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting <a href="../../agenda/2024/01-23.html">is scheduled for Tuesday, 23 January 2024</a>.
</p>

<p>
Any regrets for the next meeting? MSM.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[7/10]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-052-02: NW to consider how to schedule an “editor’s meeting”</li>
<li class="on"><code>[X]</code> QT4CG-052-06: MK to consider the editorial question of “promotion” for the symmetric relations.
<ul class="org-ul">
<li>Per <a href="https://lists.w3.org/Archives/Public/public-xslt-40/2024Jan/0014.html">https://lists.w3.org/Archives/Public/public-xslt-40/2024Jan/0014.html</a></li>
</ul></li>
<li class="on"><code>[X]</code> QT4CG-055-01: MK to clarify that the return type of the deep lookup operator is a flat sequence.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-056-04: MK to write a proposal for adding a select attribute to xsl:text</li>
<li class="on"><code>[X]</code> QT4CG-058-01: MK to clarify in <code>fn:numeric-compare</code> that -0 and +0 are equal.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-058-02: MK to consider providing more advice about the pitfalls of mixing decimal and double when sorting</li>
<li class="on"><code>[X]</code> QT4CG-060-01: NW to describe why we’re closing #899 without change</li>
<li class="on"><code>[X]</code> QT4CG-060-02: MK to sketch out a proposal with <code>subsequence</code> and <code>subsequence-where</code>.</li>
<li class="on"><code>[X]</code> QT4CG-060-03: MK to review PR and if there are no concerns, merge it without discussion next weeks</li>
<li class="on"><code>[X]</code> QT4CG-060-04: CG to make a PR to remove <code>numeric-compare</code> and consider other functions</li>
</ul>
</div>
</div>

<div id="outline-container-open-pull-requests" class="outline-3">
<h3 id="open-pull-requests"><span class="section-number-3">1.6.</span> Review of open pull requests and issues</h3>
<div class="outline-text-3" id="text-open-pull-requests">
</div>

<div id="outline-container-blocked" class="outline-4">
<h4 id="blocked"><span class="section-number-4">1.6.1.</span> Blocked</h4>
<div class="outline-text-4" id="text-blocked">
<p>
The following PRs are open but have merge conflicts or comments which
suggest they aren’t ready for action.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-795">#795</a>: 655: fn:sort-with</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-529">#529</a>: 528: revision of json(), and renaming to elements-to-maps()</li>
</ul>
</div>
</div>

<div id="outline-container-merge-without-discussion" class="outline-4">
<h4 id="merge-without-discussion"><span class="section-number-4">1.6.2.</span> Merge without discussion</h4>
<div class="outline-text-4" id="text-merge-without-discussion">
<p>
The following PRs are editorial, small, or otherwise appeared to be
uncontroversial when the agenda was prepared. The chairs propose that
these can be merged without discussion. If you think discussion is
necessary, please say so.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-947">#947</a>: Reorganise F+O chapter 15 [editorial]</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-942">#942</a>: 530 Fix typo, escape-solidus not escape-uri-attributes</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-933">#933</a>: 930 drop obsolete note about comments and PIs</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-932">#932</a>: 931 Add rules for duration precision</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-737">#737</a>: 295: Boost the capability of recursive record types</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-928">#928</a>: Minor edits through ch. 15</li>
</ul>

<p>
Proposal: merge without discussion?
</p>

<p>
Accepted.
</p>

<p>
(MK notes that we may have merge conflicts; NW to do 928 last.)
</p>
</div>
</div>

<div id="outline-container-xslt-focused" class="outline-4">
<h4 id="xslt-focused"><span class="section-number-4">1.6.3.</span> XSLT focused</h4>
<div class="outline-text-4" id="text-xslt-focused">
<p>
The following PRs appear to be candidates for a future XSLT-focused
meeting.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-871">#871</a>: Action qt4 cg 027 01 next match</li>
</ul>

<p>
These issues identify the XSLT-focused changes that have been made to
the specifications but which have not been established by the
community group as the status quo.
</p>

<ul class="org-ul">
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/168">#168</a>: XSLT Extension Instructions invoking Named Templates</li>
</ul>
</div>
</div>

<div id="outline-container-substantive" class="outline-4">
<h4 id="substantive"><span class="section-number-4">1.6.4.</span> Substantive PRs</h4>
<div class="outline-text-4" id="text-substantive">
<p>
The following substantive PRs were open when this agenda was prepared.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-943">#943</a>: 187 Add FLWOR expression while clause</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-941">#941</a>: 939 Remove fn:numeric-compare</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-940">#940</a>: 878 Add subsequence-where function</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-937">#937</a>: 779 hash function</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-936">#936</a>: 877 revised rules for op:binary-less-than</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-927">#927</a>: 861 Rewrite spec of deep lookup operator</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-921">#921</a>: 920 Allow xsl:break and xsl:next-iteration within branch of xsl:switch</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-916">#916</a>: 720 Allow methods in maps with access to $this</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-880">#880</a>: 872 Symmetry: fn:items-at → fn:get</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-874">#874</a>: 878 Proposed extension to subsequence</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-832">#832</a>: 77 Add map:deep-update and array:deep-update</li>
</ul>
</div>
</div>

<div id="outline-container-proposed-40" class="outline-4">
<h4 id="proposed-40"><span class="section-number-4">1.6.5.</span> Proposed for V4.0</h4>
<div class="outline-text-4" id="text-proposed-40">
<p>
The following issues are labled “proposed for V4.0”.
</p>

<ul class="org-ul">
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/938">#938</a>: Canonical serialization</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/937">#937</a>: 779 hash function</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/910">#910</a>: Introduce a Kollection object with functions that operate on all types of items that can be containers of unlimited number of "members"</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/908">#908</a>: Function identity: documentation still too vague</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/850">#850</a>: fn:parse-html: Finalization</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/829">#829</a>: fn:boolean: EBV support for more item types</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/716">#716</a>: Generators in XPath</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/689">#689</a>: fn:stack-trace: keep, drop, replace with $err:stack-trace ?</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/583">#583</a>: array:replace(), etc</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/557">#557</a>: fn:unparsed-binary: accessing and manipulating binary types</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/340">#340</a>: fn:format-number: Specifying decimal format</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/283">#283</a>: Enumeration types</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/260">#260</a>: array:index-of</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/236">#236</a>: map:group-by or map:build with a sequence of keys</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/33">#33</a>: json parsing number type option</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/31">#31</a>: Extend FLWOR expressions to maps</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
</div>

<div id="outline-container-pr-927" class="outline-3">
<h3 id="pr-927"><span class="section-number-3">2.1.</span> PR #927: 861 Rewrite spec of deep lookup operator</h3>
<div class="outline-text-3" id="text-pr-927">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-927">#927</a>
</p>

<p>
MK summarizes.
</p>

<ul class="org-ul">
<li>MK: This is a rewrite without any intentional changes. It defines
things a bit more precisely in response to edge cases raised in the
issue.
<ul class="org-ul">
<li>… MK describes the new exposition …</li>
</ul></li>
<li>JL: There’s no attempt to say where something was.</li>
<li>MK: No. I’m still thinking about how to do that, but it isn’t in this proposal.</li>
<li>DN: This is intended only for maps or for maps and arrays?</li>
<li>MK: It works for both.</li>
<li>DN: Nothing is said about the order of the results. Sequences are ordered.</li>
<li>MK: It’s implicit in the logic in the definition of
<code>immediate-content</code> and it’s covered in the notes that say that the
operator retains order in sequences and arrays.</li>
</ul>

<p>
Proposal: accept this PR.
</p>

<ul class="org-ul">
<li>CG: I gave some comments that I’d like to see incorporated. Mostly editorial.</li>
</ul>

<p>
ACTION QT4CG-061-01: MK to review the comments CG made on the PR #927.
</p>

<p>
NW to merge after MK reviews the comments.
</p>
</div>
</div>

<div id="outline-container-pr-916" class="outline-3">
<h3 id="pr-916"><span class="section-number-3">2.2.</span> PR #916: 720 Allow methods in maps with access to $this</h3>
<div class="outline-text-3" id="text-pr-916">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-916">#916</a>
</p>

<p>
MK expects discussion and feedback; writing the spec was an
opportunity to encourage discussion.
</p>

<ul class="org-ul">
<li>MK: The essential aim here is to define functions that can have
access to the records they’re defined on.
<ul class="org-ul">
<li>… Defines the term <code>method</code> which is a familiar term used in perhaps an unfamiliar way.</li>
<li>… It’s like a method in Javascript, sort of, but we don’t have classes or prototypes.</li>
<li>… A function annotated <code>%method</code> has access to an extra variable
<code>$this</code> which refers to the map that it’s part of.</li>
<li>… The key difficulty in making this work is “when do you bind ~$this~”?</li>
<li>… If you update a record, you don’t want the function to point to the old map.</li>
<li>… This PR does this by binding <code>$this</code> at the moment of execution.</li>
<li>… Should this be a function of the lookup operator or <code>map:get()</code>?</li>
<li>… I decided to make it binding the variable only a consequence of the lookup operator.</li>
</ul></li>
<li>JL: My original question was going to be about what happens if you
have a variable called <code>$this</code>? You’d have to bind it to another name.
<ul class="org-ul">
<li>… When you say not using <code>map:get()</code> does that preclude dynamic lookup?</li>
</ul></li>
<li>MK: No, because the lookup operator can be an expression.</li>
<li>DN: I think this is a good direction. But I have questions. It’s
possible to annotate a function as a <code>%method</code> when it isn’t in a
map. What if a function is called from a context outside the map?
And maybe the issues related to updating the map could be solved
differently. If we say that we have a <code>call()</code> function that we
apply on the map. Then the implementation of <code>call()</code>, passed a map,
can bind <code>$this$</code>. We say that functions that are members of maps
can only be called that way.</li>
<li>MK: On the point of using <code>%method</code> on functions outside of maps,
that’s what the distinction between <code>dormant</code> and <code>active</code> is about.</li>
<li>MK: I think the other suggestion is to use a different operator than
<code>?</code> for the magic semantics. The problem is a lack of symbols. I
think most users won’t think twice about the fact that there’s magic
going on here. Using a familar symbol in an intuitive way is better
even if they don’t understand the subtlties.</li>
<li>DN: It is more than that. The special <code>call</code> function can only be
called on a map and it knows how to prepare the function.</li>
<li>MK: The problem is finding a syntax that works in a way users will
appreciate. It should work like a sequence of method calls in other
languages.</li>
<li>DN: I’m asking the same question: I think the <code>call</code> function
eliminates the update problems. Using a fat arrow operator with call
would make everything work.</li>
<li>MK: It still has the characteristic that you bind <code>$this</code> at the
point where you call the function.</li>
</ul>

<p>
Some discussion of having more complex examples.
</p>

<ul class="org-ul">
<li>JL: Suppose we added <code>translate</code>, <code>rotate</code> etc on those methods
(like <code>resize). You could chain them all the way down. I think what
  DN is saying is that I can do that with ~=&gt;</code> and a <code>call</code> function.
So you get the same sense, but it’s through thick arrows and a call at each stage.</li>
<li>RD: That’s similar to how <code>$self</code> works in Python.</li>
<li>CG: I’ve already given a lot of feedback on the PR itself. I share
the concern that we shouldn’t treat the lookup operator and
<code>map:get</code> differently. We might want to make them the same after
compilation and we have lots of users that don’t use the lookup
operator.
<ul class="org-ul">
<li>… More generally, I have some concerns that we’re trying to
simulate objects, but if we went a little further we could have
more power and performance by having something more like objects.</li>
<li>… Objects at their core are very simple; maps are a lot more
powerful, but much of that power isn’t needed for objects. What we
need for objects is not much. And we could think about inheritance
and other features.</li>
</ul></li>
<li>MK: Trying to do things one step time; JS combines maps and objects.</li>
<li>DN: I think what CG says makes perfect sense. We could just use
functions with a special argument and use them with the fat arrow.
If you don’t use the right first argument, you’ll get an error.</li>
<li>MK: Yes, I think I understand. I’ll explore that further.</li>
<li>RD: One thing that JS JIT compilers do is optimizations on the
types. They have a similar issue where the content of the map or
object can change at any time. They keep track of the different
shapes that the object has.</li>
<li>MK: Data flow analysis in effect.</li>
<li>RD: An XQuery or XPath processor could do similar sorts of things to
produce more concrete representations of these class-like maps.</li>
<li>CG: Yes, that’s a good point.
<ul class="org-ul">
<li>… If you have a map:put function and the value can be dynamic,
it’s difficult to find out if the result will be compliant with
the existing record. In those cases, if you had a fixed record
constructor…</li>
</ul></li>
<li>MK: Yes. I am thinking of introducing a fixed record constructor,
but I think that’s orthogonal and complementary.</li>
<li>CG: And we could have final methods that can’t be removed.
<ul class="org-ul">
<li>… And I wonder if <code>$this</code> could be explicitly available in a
record constructor to avoid having to have the <code>%method</code>
annotation.</li>
</ul></li>
<li>RD: Also, it would be useful to see if we can extend this to things
that aren’t maps. It’s quite common to have a whole set of functions
that have the first argument as the object to be operated on.</li>
<li>MK: The problem with <code>call()</code> approach is that the function lookup
in the <code>=&gt;</code> is in the global namespace. You get no function
overloading.</li>
<li>RD: You can have a user object for example and pass that as
arguments to add, remove, change, etc. That produces a class-like
thing.</li>
<li>MK: I’m not sure where you’re heading.</li>
<li>RD: I’m just saying that pattern is common outside of maps. I wonder
if we could extend it.</li>
</ul>

<p>
JL wonders if using the <code>=&gt;</code> operator would mean having to repeat the
map several times, once for lookup and again for access.
</p>

<ul class="org-ul">
<li>MK: Yes, the fat arrow followed by something that looks like a function does global lookup.</li>
<li>JL: Couldn’t we use something like a variable on the right hand side?</li>
<li>MK: Yes, and where do you bind that?</li>
<li>JL: I think DN’s proposal for <code>call</code> is to pass the map and the
function as two arguments, then you know which function to call. So
the map has to appear twice.</li>
<li>DN: The discussion so far has convinced me that what RD proposed is
the best solution. We don’t need anything to be related to maps at
all; they’re just functions that have a special first argument
called <code>$self</code>. They can be applied to anything with the <code>=&gt;</code>.</li>
<li>MK: Are they global functions?</li>
<li>DN: They could be global or they could be dynamic. It doesn’t matter.
<ul class="org-ul">
<li>… What ever is on the left hand side of the arrow is subsituted for the <code>self</code>.</li>
</ul></li>
<li>MK: How do you provide a resize function for rectangles and circles
without putting them all in the same global namespace?</li>
</ul>

<p>
MK will give some thought to how to solve the global namespace problem.
</p>
</div>
</div>

<div id="outline-container-pr-832" class="outline-3">
<h3 id="pr-832"><span class="section-number-3">2.3.</span> PR #832: 77 Add map:deep-update and array:deep-update</h3>
<div class="outline-text-3" id="text-pr-832">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-832">#832</a>
</p>

<p>
MK summarizes the changes in the PR.
</p>

<ul class="org-ul">
<li>MK: There’s an effort here to make the operation intuitive, but that
means there’s a lot of detail to make that work.
<ul class="org-ul">
<li>… MK reviews some of the examples …</li>
</ul></li>
<li>MK: The mechanism to make that work is complex. It relies on
defining properties of items as notations. 
<ul class="org-ul">
<li>… MK walks through the description of the conceptual operation …</li>
<li>… The magic properties are used purely internally. But the
semantics are defined in terms of a temporary data model that does
things that the publicly exposed data model doesn’t support.</li>
</ul></li>
<li>JL: These are arbitrary replacements, so you could have finds that
are deep down but their parents are removed later.</li>
<li>MK: Yes, you might update something that’s a waste of time because
it’s parent has disappeared. It’s well defined, even if it allows
users to do things that are useless.</li>
<li>JL: In the change function, do I know both the value and the
effective key?</li>
<li>MK: There’s a question of whether you make the attached properties
visible. Clearly one could.</li>
<li>MK: If the properties are annotations, you can use the existing
functions to get the annotations.</li>
<li>CG: I’ve given a lot of feedback. My main concerns are still the same.
<ul class="org-ul">
<li>… The implicit binding of data that isn’t visible to the user is
problematic. In XQuery Update we had a scoring value that worked
this way. We dropped it eventually because we were never happy
with it. You couldn’t tell what was going on internally.</li>
<li>… I’d be much happier with a mechnism that passed a map describing
what things should be changed.</li>
</ul></li>
<li>MK: Yes. I tried to avoid doing this with a sort of mini-selector
language. I didn’t want to define another little language that we
have for selectors that can only be used in this. I’d like to avoid that.</li>
<li>RD: MarkLogic does a similar thing. Some of the APIs take a subset
of an XPath expression and use that not as a selection but as a
mechanism for applying it. In effect, that isn’t really a new
language, it’s just a restriction on what constructs of XPath you
can have.</li>
<li>MK: That voilates orthogonality which I’d like to avoid.</li>
</ul>

<p>
MK proposes to develop some of the things that are complimentary to it
and see how we get on.
</p>

<ul class="org-ul">
<li>MK: I do think we need to address some hard issues with map and
array transformations, JSON transformations. One of the ways of
doing that might be to develop use cases that are high-level that
show how lots of different facilities work together to solve an
application level problem.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business?</h2>
<div class="outline-text-2" id="text-any-other-business">
<p>
None heard.
</p>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">4.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
</div>
</div>
</div>
</body>
</html>